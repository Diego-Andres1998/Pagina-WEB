<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portal Estudiantil Minimalista - Horario de Clases</title> <!-- Título actualizado -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Incluye Tailwind CSS para el estilo rápido y responsivo del calendario -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <header>
        <div class="container">
            <a href="#" class="logo" data-section="main-menu">
                <img src="https://cftdelosrios.cl/wp-content/uploads/2021/09/cropped-Recurso-2.png" alt="Logo CFT Los Ríos"> <!-- Placeholder for cropped-Recurso-2.png -->
            </a>
            <button class="menu-toggle" aria-label="Abrir menú">&#9776;</button>
            <nav>
                <ul>
                    <li><a href="https://cftdelosrios.cl/" target="_blank" class="btn-nav-link">Página Oficial</a></li>
                    <li id="carreras-nav-link" style="display: none;"><a href="#" data-section="carreras-info" class="btn-nav-link">Carreras</a></li> 
                    <li id="admision-nav-link" style="display: none;"><a href="#" data-section="admision" class="btn-nav-link">Admisión</a></li>
                    <li id="vida-estudiantil-nav-link" style="display: none;"><a href="#" data-section="vida-estudiantil" class="btn-nav-link">Vida Estudiantil</a></li>
                    <li id="noticias-nav-link" style="display: none;"><a href="#" data-section="noticias" class="btn-nav-link">Noticias</a></li>
                    
                    <!-- Contenedor de Búsqueda en Navegación -->
                    <li id="nav-search-li" style="display: none;"> <!-- Se controla visibilidad con JS -->
                        <div class="nav-search-container">
                            <input type="search" id="nav-search-input" placeholder="Buscar en el sitio...">
                            <button id="nav-search-button"><i class="fas fa-search"></i></button>
                        </div>
                    </li>
                    
                    <!-- Botón de Cambio de Tema -->
                    <li id="theme-toggle-li" style="display: list-item; margin-left: auto;"> <!-- Se muestra siempre, alineado a la derecha antes del perfil -->
                         <button id="theme-toggle-button" aria-label="Cambiar tema">
                            <i class="fas fa-moon"></i> <!-- Icono inicial (luna para tema claro) -->
                        </button>
                    </li>

                    <li id="profile-nav-link" style="display: none;">
                        <a href="#"> 
                            <img id="nav-profile-pic" src="https://placehold.co/35x35/D3D3D3/000?text=Avatar" alt="Mi Perfil"> <!-- Placeholder for default-avatar.png -->
                        </a>
                        <div id="profile-dropdown" class="profile-dropdown-content">
                            <div class="dropdown-header">
                                <img id="dropdown-profile-pic" src="https://placehold.co/40x40/D3D3D3/000?text=Avatar" alt="Foto de Perfil"> <!-- Placeholder for default-avatar.png -->
                                <span id="dropdown-username"></span>
                            </div>
                            <a href="#" data-section="user-profile-detail">Ver Perfil Completo</a>
                            <a href="#" data-action="logout">Cerrar Sesión</a>
                        </div>
                    </li>
                </ul>
            </nav>
        </div>
    </header>

    <main>
        <div class="container">
            <section id="home-section" class="content-section active-section">
                <!-- El contenido se insertará aquí por JS -->
            </section>

            <section id="profile-section" class="content-section" style="display: none;">
                <h1>Mi Perfil</h1>
                <p>Bienvenido/a, <span id="user-email-display"></span>!</p>
                <p>Aquí verás tus datos personales y otra información.</p>
            </section>

            <section id="user-profile-detail-section" class="content-section">
                <button class="back-button" data-target-section="modules">Volver</button>
                <div class="profile-detail-card">
                    <h2>Detalles de mi Perfil</h2>
                    <form id="profile-form">
                        <div class="profile-pic-container">
                            <img id="profile-pic" src="https://placehold.co/120x120/D3D3D3/000?text=Avatar" alt="Foto de Perfil"> <!-- Placeholder for default-avatar.png -->
                            <input type="file" id="profile-image-upload" accept="image/*">
                            <br>
                            <button type="button" class="btn-delete-pic" id="delete-profile-pic-btn" style="display:none;">Eliminar Foto</button>
                        </div>

                        <div class="form-group">
                            <label for="profile-name">Nombre Completo:</label>
                            <input type="text" id="profile-name" value="Nombre del Estudiante" disabled>
                        </div>
                        <div class="form-group">
                            <label for="profile-email">Correo Electrónico:</label>
                            <input type="email" id="profile-email" value="estudiante@cftlosrios.cl" disabled>
                        </div>
                        <div class="form-group">
                            <label for="profile-phone">Número de Teléfono:</label>
                            <input type="tel" id="profile-phone" value="+56 9 1234 5678" disabled>
                        </div>
                        <div class="form-group">
                            <label for="profile-rut">RUT Chileno:</label>
                            <input type="text" id="profile-rut" value="12.345.678-K" disabled placeholder="Ej: 12.345.678-K">
                            <small style="color: var(--color-texto-claro);">Este campo es solo decorativo y no se validará.</small>
                        </div>
                        <div class="button-group">
                            <button type="button" class="btn-primario" id="edit-profile-btn">Editar Perfil</button>
                            <button type="submit" class="btn-primario" id="save-profile-btn" style="display: none;">Guardar Cambios</button>
                            <button type="button" class="btn-secundario" id="cancel-edit-btn" style="display: none;">Cancelar</button>
                        </div>
                        <p id="profile-message" style="margin-top: 15px;"></p>
                    </form>
                </div>
            </section>

            <section id="modules-section" class="modules-grid">
                <!-- El contenido se insertará aquí por JS -->
            </section>

            <section id="carreras-info-section" class="content-section" style="text-align: left; color: var(--color-texto);"> <!-- NUEVA SECCIÓN PARA INFORMACIÓN DE CARRERAS -->
                <button class="back-button" data-target-section="modules">Volver</button>
                <h1>Oferta de Carreras CFT Estatal de Los Ríos</h1>
                <p style="color: var(--color-texto); font-size: 1.1em; margin-bottom: var(--espaciado-md);">A continuación, se detalla la oferta de carreras:</p>
                <ul style="list-style-type: disc; margin-left: 20px; color: var(--color-texto); margin-bottom: var(--espaciado-md);">
                    <li>TNS en Podología Clínica</li>
                    <li>TNS en Electricidad mención Energías Renovables</li>
                    <li>TNS en Enfermería</li>
                    <li>TNS en Comunicación Audiovisual</li>
                    <li>TNS en Automatización</li>
                    <li>TNS en Construcción mención Eficiencia Energética</li>
                    <li>TNS en Agroindustria e Innovación Alimentaria</li>
                    <li>TNS en Informática y Data Science</li>
                    <li>TNS en Refrigeración y Climatización</li>
                    <li>TNS en Administración Pública Privada</li>
                    <li>TNS en Turismo de Intereses Especiales</li>
                </ul>

                <h2 style="color: var(--color-primario); margin-bottom: var(--espaciado-sm); margin-top: var(--espaciado-lg); font-size: 1.8em;">Nuevas Carreras para 2025</h2>
                <p style="color: var(--color-texto); font-size: 1.1em; margin-bottom: var(--espaciado-md);">Para el año académico 2025, se han destacado algunas nuevas carreras:</p>
                <ul style="list-style-type: disc; margin-left: 20px; color: var(--color-texto); margin-bottom: var(--espaciado-md);">
                    <li><strong>TNS en Agroindustria e Innovación Alimentaria</strong> es una nueva carrera para el 2025.</li>
                    <li><strong>TNS en Informática y Data Science</strong> también se presenta como una nueva carrera para el 2025.</li>
                    <li>En la Sede Paillaco, se ofrece como <strong>NUEVA CARRERA</strong> la <strong>TNS en Administración Pública y Privada</strong>.</li>
                </ul>

                <h2 style="color: var(--color-primario); margin-bottom: var(--espaciado-sm); margin-top: var(--espaciado-lg); font-size: 1.8em;">Información Adicional</h2>
                <p style="color: var(--color-texto); font-size: 1.1em; margin-bottom: var(--espaciado-sm);">
                    El CFT Estatal de Los Ríos está adscrito a Gratuidad, lo que permite a los estudiantes formarse en sus sedes ubicadas en La Unión, Paillaco, Panguipulli y Valdivia.
                </p>
                <p style="color: var(--color-texto); font-size: 1.1em; margin-bottom: var(--espaciado-sm);">
                    La institución busca formar técnicos que lideren el desarrollo de la Región de los Ríos.
                </p>
                <p style="color: var(--color-texto); font-size: 1.1em; margin-bottom: var(--espaciado-md);">
                    Su sello educativo promueve el desarrollo de Habilidades Sociales, Innovación y Emprendimiento en sus estudiantes.
                </p>
            </section>

            <section id="notes-attendance-section" class="content-section">
                <button class="back-button" data-target-section="modules">Volver</button>
                <h1 class="dashboard-title"><i class="fas fa-book-open"></i> Rendimiento Académico</h1>
                
                <div class="materias-grid">
                    <!-- Materia 1 -->
                    <div class="materia-card">
                        <div class="materia-header">
                            <h3><i class="fas fa-calculator"></i> Nivelación de Matemáticas</h3>
                        </div>
                        <div class="materia-content">
                            <div class="unidades-container">
                                <div class="unidad">
                                    <h4>Unidad 1 <span>Asistencia: 82.3%</span></h4>
                                    <div class="notas-container">
                                        <div class="nota">
                                            <span class="nota-label">Nota 1</span>
                                            <span class="nota-value">4.5</span>
                                        </div>
                                        <div class="nota">
                                            <span class="nota-label">Nota 2</span>
                                            <span class="nota-value">5.2</span>
                                        </div>
                                    </div>
                                    <div class="promedio-container">
                                        <span class="promedio-label">Promedio:</span>
                                        <span class="promedio-value">4.85</span>
                                    </div>
                                </div>
                                <div class="unidad">
                                    <h4>Unidad 2 <span>Asistencia: 89.7%</span></h4>
                                    <div class="notas-container">
                                        <div class="nota">
                                            <span class="nota-label">Nota 1</span>
                                            <span class="nota-value">5.8</span>
                                        </div>
                                        <div class="nota">
                                            <span class="nota-label">Nota 2</span>
                                            <span class="nota-value">6.3</span>
                                        </div>
                                    </div>
                                    <div class="promedio-container">
                                        <span class="promedio-label">Promedio:</span>
                                        <span class="promedio-value">6.05</span>
                                    </div>
                                </div>
                                <div class="unidad">
                                    <h4>Unidad 3 <span>Asistencia: 76.5%</span></h4>
                                    <div class="notas-container">
                                        <div class="nota">
                                            <span class="nota-label">Nota 1</span>
                                            <span class="nota-value">3.9</span>
                                        </div>
                                        <div class="nota">
                                            <span class="nota-label">Nota 2</span>
                                            <span class="nota-value">4.7</span>
                                        </div>
                                    </div>
                                    <div class="promedio-container">
                                        <span class="promedio-label">Promedio:</span>
                                        <span class="promedio-value">4.30</span>
                                    </div>
                                </div>
                                <div class="unidad">
                                    <h4>Unidad 4 <span>Asistencia: 94.2%</span></h4>
                                    <div class="notas-container">
                                        <div class="nota">
                                            <span class="nota-label">Nota 1</span>
                                            <span class="nota-value">6.2</span>
                                        </div>
                                        <div class="nota">
                                            <span class="nota-label">Nota 2</span>
                                            <span class="nota-value">5.8</span>
                                        </div>
                                    </div>
                                    <div class="promedio-container">
                                        <span class="promedio-label">Promedio:</span>
                                        <span class="promedio-value">6.00</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="asistencia">
                            <span>Asistencia Total:</span>
                            <span class="asistencia-value">85.7%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress" style="width: 85.7%"></div>
                        </div>
                    </div>
                    
                    <!-- Materia 2 -->
                    <div class="materia-card">
                        <div class="materia-header">
                            <h3><i class="fas fa-laptop-code"></i> Introducción a Programación</h3>
                        </div>
                        <div class="materia-content">
                            <div class="unidades-container">
                                <div class="unidad">
                                    <h4>Unidad 1 <span>Asistencia: 95.8%</span></h4>
                                    <div class="notas-container">
                                        <div class="nota">
                                            <span class="nota-label">Nota 1</span>
                                            <span class="nota-value">6.5</span>
                                        </div>
                                        <div class="nota">
                                            <span class="nota-label">Nota 2</span>
                                            <span class="nota-value">7.0</span>
                                        </div>
                                    </div>
                                    <div class="promedio-container">
                                        <span class="promedio-label">Promedio:</span>
                                        <span class="promedio-value">6.75</span>
                                    </div>
                                </div>
                                <div class="unidad">
                                    <h4>Unidad 2 <span>Asistencia: 98.4%</span></h4>
                                    <div class="notas-container">
                                        <div class="nota">
                                            <span class="nota-label">Nota 1</span>
                                            <span class="nota-value">7.0</span>
                                        </div>
                                        <div class="nota">
                                            <span class="nota-label">Nota 2</span>
                                            <span class="nota-value">6.9</span>
                                        </div>
                                    </div>
                                    <div class="promedio-container">
                                        <span class="promedio-label">Promedio:</span>
                                        <span class="promedio-value">6.95</span>
                                    </div>
                                </div>
                                <div class="unidad">
                                    <h4>Unidad 3 <span>Asistencia: 92.1%</span></h4>
                                    <div class="notas-container">
                                        <div class="nota">
                                            <span class="nota-label">Nota 1</span>
                                            <span class="nota-value">5.7</span>
                                        </div>
                                        <div class="nota">
                                            <span class="nota-label">Nota 2</span>
                                            <span class="nota-value">6.8</span>
                                        </div>
                                    </div>
                                    <div class="promedio-container">
                                        <span class="promedio-label">Promedio:</span>
                                        <span class="promedio-value">6.25</span>
                                    </div>
                                </div>
                                <div class="unidad">
                                    <h4>Unidad 4 <span>Asistencia: 99.0%</span></h4>
                                    <div class="notas-container">
                                        <div class="nota">
                                            <span class="nota-label">Nota 1</span>
                                            <span class="nota-value">6.9</span>
                                        </div>
                                        <div class="nota">
                                            <span class="nota-label">Nota 2</span>
                                            <span class="nota-value">7.0</span>
                                        </div>
                                    </div>
                                    <div class="promedio-container">
                                        <span class="promedio-label">Promedio:</span>
                                        <span class="promedio-value">6.95</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="asistencia">
                            <span>Asistencia Total:</span>
                            <span class="asistencia-value">96.3%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress" style="width: 96.3%"></div>
                        </div>
                    </div>
                    
                    <!-- Materia 3 -->
                    <div class="materia-card">
                        <div class="materia-header">
                            <h3><i class="fas fa-chart-line"></i> Fundamentos de Data Science</h3>
                        </div>
                        <div class="materia-content">
                            <div class="unidades-container">
                                <div class="unidad">
                                    <h4>Unidad 1 <span>Asistencia: 78.9%</span></h4>
                                    <div class="notas-container">
                                        <div class="nota">
                                            <span class="nota-label">Nota 1</span>
                                            <span class="nota-value">3.5</span>
                                        </div>
                                        <div class="nota">
                                            <span class="nota-label">Nota 2</span>
                                            <span class="nota-value">4.1</span>
                                        </div>
                                    </div>
                                    <div class="promedio-container">
                                        <span class="promedio-label">Promedio:</span>
                                        <span class="promedio-value">3.80</span>
                                    </div>
                                </div>
                                <div class="unidad">
                                    <h4>Unidad 2 <span>Asistencia: 85.3%</span></h4>
                                    <div class="notas-container">
                                        <div class="nota">
                                            <span class="nota-label">Nota 1</span>
                                            <span class="nota-value">5.0</span>
                                        </div>
                                        <div class="nota">
                                            <span class="nota-label">Nota 2</span>
                                            <span class="nota-value">6.0</span>
                                        </div>
                                    </div>
                                    <div class="promedio-container">
                                        <span class="promedio-label">Promedio:</span>
                                        <span class="promedio-value">5.50</span>
                                    </div>
                                </div>
                                <div class="unidad">
                                    <h4>Unidad 3 <span>Asistencia: 91.7%</span></h4>
                                    <div class="notas-container">
                                        <div class="nota">
                                            <span class="nota-label">Nota 1</span>
                                            <span class="nota-value">6.5</span>
                                        </div>
                                        <div class="nota">
                                            <span class="nota-label">Nota 2</span>
                                            <span class="nota-value">5.8</span>
                                        </div>
                                    </div>
                                    <div class="promedio-container">
                                        <span class="promedio-label">Promedio:</span>
                                        <span class="promedio-value">6.15</span>
                                    </div>
                                </div>
                                <div class="unidad">
                                    <h4>Unidad 4 <span>Asistencia: 96.5%</span></h4>
                                    <div class="notas-container">
                                        <div class="nota">
                                            <span class="nota-label">Nota 1</span>
                                            <span class="nota-value">6.8</span>
                                            </div>
                                        <div class="nota">
                                            <span class="nota-label">Nota 2</span>
                                            <span class="nota-value">7.0</span>
                                        </div>
                                    </div>
                                    <div class="promedio-container">
                                        <span class="promedio-label">Promedio:</span>
                                        <span class="promedio-value">6.90</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="asistencia">
                            <span>Asistencia Total:</span>
                            <span class="asistencia-value">88.1%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress" style="width: 88.1%"></div>
                        </div>
                    </div>
                    
                    <!-- Materia 4 -->
                    <div class="materia-card">
                        <div class="materia-header">
                            <h3><i class="fas fa-briefcase"></i> Apresto Laboral</h3>
                        </div>
                        <div class="materia-content">
                            <div class="unidades-container">
                                <div class="unidad">
                                    <h4>Unidad 1 <span>Asistencia: 83.4%</span></h4>
                                    <div class="notas-container">
                                        <div class="nota">
                                            <span class="nota-label">Nota 1</span>
                                            <span class="nota-value">4.0</span>
                                        </div>
                                        <div class="nota">
                                            <span class="nota-label">Nota 2</span>
                                            <span class="nota-value">5.0</span>
                                        </div>
                                    </div>
                                    <div class="promedio-container">
                                        <span class="promedio-label">Promedio:</span>
                                        <span class="promedio-value">4.50</span>
                                    </div>
                                </div>
                                <div class="unidad">
                                    <h4>Unidad 2 <span>Asistencia: 88.9%</span></h4>
                                    <div class="notas-container">
                                        <div class="nota">
                                            <span class="nota-label">Nota 1</span>
                                            <span class="nota-value">5.5</span>
                                        </div>
                                        <div class="nota">
                                            <span class="nota-label">Nota 2</span>
                                            <span class="nota-value">6.1</span>
                                        </div>
                                    </div>
                                    <div class="promedio-container">
                                        <span class="promedio-label">Promedio:</span>
                                        <span class="promedio-value">5.80</span>
                                    </div>
                                </div>
                                <div class="unidad">
                                    <h4>Unidad 3 <span>Asistencia: 94.7%</span></h4>
                                    <div class="notas-container">
                                        <div class="nota">
                                            <span class="nota-label">Nota 1</span>
                                            <span class="nota-value">6.2</span>
                                        </div>
                                        <div class="nota">
                                            <span class="nota-label">Nota 2</span>
                                            <span class="nota-value">7.0</span>
                                        </div>
                                    </div>
                                    <div class="promedio-container">
                                        <span class="promedio-label">Promedio:</span>
                                        <span class="promedio-value">6.60</span>
                                    </div>
                                </div>
                                <div class="unidad">
                                    <h4>Unidad 4 <span>Asistencia: 97.3%</span></h4>
                                    <div class="notas-container">
                                        <div class="nota">
                                            <span class="nota-label">Nota 1</span>
                                            <span class="nota-value">6.5</span>
                                        </div>
                                        <div class="nota">
                                            <span class="nota-label">Nota 2</span>
                                            <span class="nota-value">6.8</span>
                                        </div>
                                    </div>
                                    <div class="promedio-container">
                                        <span class="promedio-label">Promedio:</span>
                                        <span class="promedio-value">6.65</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="asistencia">
                            <span>Asistencia Total:</span>
                            <span class="asistencia-value">91.1%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress" style="width: 91.1%"></div>
                        </div>
                    </div>
                    
                    <!-- Materia 5 -->
                    <div class="materia-card">
                        <div class="materia-header">
                            <h3><i class="fas fa-language"></i> Inglés I</h3>
                        </div>
                        <div class="materia-content">
                            <div class="unidades-container">
                                <div class="unidad">
                                    <h4>Unidad 1 <span>Asistencia: 86.2%</span></h4>
                                    <div class="notas-container">
                                        <div class="nota">
                                            <span class="nota-label">Nota 1</span>
                                            <span class="nota-value">5.2</span>
                                        </div>
                                        <div class="nota">
                                            <span class="nota-label">Nota 2</span>
                                            <span class="nota-value">4.8</span>
                                        </div>
                                    </div>
                                    <div class="promedio-container">
                                        <span class="promedio-label">Promedio:</span>
                                        <span class="promedio-value">5.00</span>
                                    </div>
                                </div>
                                <div class="unidad">
                                    <h4>Unidad 2 <span>Asistencia: 80.5%</span></h4>
                                    <div class="notas-container">
                                        <div class="nota">
                                            <span class="nota-label">Nota 1</span>
                                            <span class="nota-value">4.0</span>
                                        </div>
                                        <div class="nota">
                                            <span class="nota-label">Nota 2</span>
                                            <span class="nota-value">4.6</span>
                                        </div>
                                    </div>
                                    <div class="promedio-container">
                                        <span class="promedio-label">Promedio:</span>
                                        <span class="promedio-value">4.30</span>
                                    </div>
                                </div>
                                <div class="unidad">
                                    <h4>Unidad 3 <span>Asistencia: 98.9%</span></h4>
                                    <div class="notas-container">
                                        <div class="nota">
                                            <span class="nota-label">Nota 1</span>
                                            <span class="nota-value">6.7</span>
                                        </div>
                                        <div class="nota">
                                            <span class="nota-label">Nota 2</span>
                                            <span class="nota-value">7.0</span>
                                        </div>
                                    </div>
                                    <div class="promedio-container">
                                        <span class="promedio-label">Promedio:</span>
                                        <span class="promedio-value">6.85</span>
                                    </div>
                                </div>
                                <div class="unidad">
                                    <h4>Unidad 4 <span>Asistencia: 100%</span></h4>
                                    <div class="notas-container">
                                        <div class="nota">
                                            <span class="nota-label">Nota 1</span>
                                            <span class="nota-value">7.0</span>
                                        </div>
                                        <div class="nota">
                                            <span class="nota-label">Nota 2</span>
                                            <span class="nota-value">6.9</span>
                                        </div>
                                    </div>
                                    <div class="promedio-container">
                                        <span class="promedio-label">Promedio:</span>
                                        <span class="promedio-value">6.95</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="asistencia">
                            <span>Asistencia Total:</span>
                            <span class="asistencia-value">91.4%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress" style="width: 91.4%"></div>
                        </div>
                    </div>
                </div>
            </section>

            <section id="academic-calendar-section" class="content-section">
                <button class="back-button" data-target-section="modules">Volver</button>
                <!-- Contenido del Calendario Académico -->
                <div class="schedule-container rounded-lg">
                    <h1 class="text-3xl font-bold text-center mb-8 text-gray-800">Horario de Clases</h1>
                    <table class="min-w-full bg-white rounded-lg overflow-hidden">
                        <thead class="bg-blue-800 text-white">
                            <tr>
                                <th class="py-3 px-4 rounded-tl-lg">Mod</th>
                                <th class="py-3 px-4">Hora</th>
                                <th class="py-3 px-4">Lunes</th>
                                <th class="py-3 px-4">Martes</th>
                                <th class="py-3 px-4">Miércoles</th>
                                <th class="py-3 px-4">Jueves</th>
                                <th class="py-3 px-4 rounded-tr-lg">Viernes</th>
                                <!-- Sábado y Domingo no tienen clases según el horario, así que se omiten o se dejan vacíos -->
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Mod 1 -->
                            <tr>
                                <td class="time-slot rounded-bl-lg">1</td>
                                <td class="time-slot">08:30-09:15</td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <!-- Mod 2 -->
                            <tr>
                                <td class="time-slot">2</td>
                                <td class="time-slot">09:15-10:00</td>
                                <td><div class="subject-cell">TALLER DE APRESTO LABORAL</div></td>
                                <td><div class="subject-cell">NIVELACIÓN DE MATEMÁTICAS</div></td>
                                <td></td>
                                <td><div class="subject-cell">INTRODUCCIÓN A LA PROGRAMACIÓN</div></td>
                                <td></td>
                            </tr>
                            <!-- Mod 3 -->
                            <tr>
                                <td class="time-slot">3</td>
                                <td class="time-slot">10:15-11:00</td>
                                <td><div class="subject-cell">TALLER DE APRESTO LABORAL</div></td>
                                <td><div class="subject-cell">NIVELACIÓN DE MATEMÁTICAS</div></td>
                                <td></td>
                                <td><div class="subject-cell">INTRODUCCIÓN A LA PROGRAMACIÓN</div></td>
                                <td></td>
                            </tr>
                            <!-- Mod 4 -->
                            <tr>
                                <td class="time-slot">4</td>
                                <td class="time-slot">11:00-11:45</td>
                                <td><div class="subject-cell">NIVELACIÓN DE MATEMÁTICAS</div></td>
                                <td></td>
                                <td><div class="subject-cell">TALLER DE APRESTO LABORAL</div></td>
                                <td><div class="subject-cell">INTRODUCCIÓN A LA PROGRAMACIÓN</div></td>
                                <td></td>
                            </tr>
                            <!-- Mod 5 -->
                            <tr>
                                <td class="time-slot">5</td>
                                <td class="time-slot">11:55-12:40</td>
                                <td><div class="subject-cell">NIVELACIÓN DE MATEMÁTICAS</div></td>
                                <td><div class="subject-cell">INTRODUCCIÓN A LA PROGRAMACIÓN</div></td>
                                <td><div class="subject-cell">TALLER DE APRESTO LABORAL</div></td>
                                <td><div class="subject-cell">TIC</div></td>
                                <td></td>
                            </tr>
                            <!-- Mod 6 -->
                            <tr>
                                <td class="time-slot">6</td>
                                <td class="time-slot">12:40-13:20</td>
                                <td></td>
                                <td><div class="subject-cell">INTRODUCCIÓN A LA PROGRAMACIÓN</div></td>
                                <td><div class="subject-cell">FUNDAMENTOS DATA SCIENCE</div></td>
                                <td><div class="subject-cell">TIC</div></td>
                                <td></td>
                            </tr>
                            <!-- Mod 7 -->
                            <tr>
                                <td class="time-slot">7</td>
                                <td class="time-slot">13:35-14:20</td>
                                <td><div class="subject-cell">INGLÉS I</div></td>
                                <td></td>
                                <td><div class="subject-cell">FUNDAMENTOS DATA SCIENCE</div></td>
                                <td><div class="subject-cell">TIC</div></td>
                                <td></td>
                            </tr>
                            <!-- Mod 8 -->
                            <tr>
                                <td class="time-slot">8</td>
                                <td class="time-slot">14:20-15:05</td>
                                <td><div class="subject-cell">INGLÉS I</div></td>
                                <td></td>
                                <td><div class="subject-cell">FUNDAMENTOS DATA SCIENCE</div></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <!-- Mod 9 -->
                            <tr>
                                <td class="time-slot">9</td>
                                <td class="time-slot">15:15-16:00</td>
                                <td><div class="subject-cell">INGLÉS I</div></td>
                                <td></td>
                                <td><div class="subject-cell">FUNDAMENTOS DATA SCIENCE</div></td>
                                <td><div class="subject-cell">INGLÉS I</div></td>
                                <td></td>
                            </tr>
                            <!-- Mod 10 -->
                            <tr>
                                <td class="time-slot">10</td>
                                <td class="time-slot">16:00-16:45</td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td><div class="subject-cell">INGLÉS I</div></td>
                                <td></td>
                            </tr>
                            <!-- Resto de módulos sin clases, se mantienen vacíos o se pueden omitir si no son relevantes -->
                            <tr>
                                <td class="time-slot">11</td>
                                <td class="time-slot">16:50-17:35</td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td class="time-slot">12</td>
                                <td class="time-slot">17:35-18:20</td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td class="time-slot">13</td>
                                <td class="time-slot">18:30-19:10</td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td class="time-slot">14</td>
                                <td class="time-slot">19:10-19:50</td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td class="time-slot">15</td>
                                <td class="time-slot">19:50 - 20:30</td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td class="time-slot">16</td>
                                <td class="time-slot">20:30-21:10</td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td class="time-slot">17</td>
                                <td class="time-slot">21:10-21:50</td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td class="time-slot rounded-br-lg">18</td>
                                <td class="time-slot">21:50-22:30</td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Sección de Notificaciones - Nueva -->
            <section id="notifications-section" class="content-section">
                <button class="back-button" data-target-section="modules">Volver</button>
                <div class="bg-white p-8 rounded-2xl shadow-2xl w-full max-w-md border border-gray-200 mx-auto mt-8">
                    <div class="text-center mb-6">
                        <!-- Icono de campana de notificaciones -->
                        <svg class="mx-auto h-16 w-16 text-indigo-500 mb-4 animate-bounce" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"></path>
                        </svg>
                        <h1 class="text-3xl font-extrabold text-gray-800 mb-2">Enviar Notificaciones</h1>
                        <p class="text-gray-600">Envía avisos importantes por correo y SMS.</p>
                    </div>

                    <form id="notificationForm" class="space-y-4">
                        <div>
                            <label for="email_notification" class="block text-sm font-medium text-gray-700 mb-1">Correo Electrónico</label>
                            <input type="email" id="email_notification" name="email_notification" placeholder="tu.correo@ejemplo.com" required
                                class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-indigo-500 focus:border-indigo-500 transition duration-200 ease-in-out">
                        </div>
                        <div>
                            <label for="phone_notification" class="block text-sm font-medium text-gray-700 mb-1">Número de Teléfono</label>
                            <input type="tel" id="phone_notification" name="phone_notification" placeholder="+56 9 1234 5678" required
                                class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-indigo-500 focus:border-indigo-500 transition duration-200 ease-in-out">
                        </div>
                        <div>
                            <label for="message_notification" class="block text-sm font-medium text-gray-700 mb-1">Mensaje</label>
                            <textarea id="message_notification" name="message_notification" rows="4" placeholder="Escribe tu notificación aquí..." required
                                class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-indigo-500 focus:border-indigo-500 resize-y transition duration-200 ease-in-out"></textarea>
                        </div>

                        <button type="submit"
                                class="w-full bg-indigo-600 text-white py-3 px-4 rounded-lg font-semibold text-lg shadow-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition duration-300 ease-in-out transform hover:scale-105">
                            Enviar Notificación
                        </button>
                    </form>

                    <!-- Área para mostrar mensajes al usuario -->
                    <div id="responseMessageNotification" class="mt-6 p-4 rounded-lg text-center hidden"></div>
                </div>
            </section>

            <!-- Sección de Directorio - NUEVA -->
            <section id="directory-section" class="content-section">
                <button class="back-button" data-target-section="modules">Volver</button>
                <h1>Directorio del CFT Los Ríos</h1>
                <p>Encuentra fácilmente la información de contacto de docentes y personal.</p>
                <!-- Modificación aquí: el directory-list ya no es un grid por si mismo, contendrá los grids por sede -->
                <div id="directory-list">
                    <!-- Los elementos del directorio se cargarán aquí dinámicamente con JavaScript -->
                </div>
            </section>

            <!-- Sección de Becas y Beneficios - NUEVA -->
            <section id="scholarships-section" class="content-section">
                <button class="back-button" data-target-section="modules">Volver</button>
                <h1>Guía de Becas para la Educación Superior en Chile (Ministerio de Educación)</h1>
                <p>¡Hola! Como interesado en la educación superior en Chile, he recopilado la información esencial sobre las becas que ofrece el Ministerio de Educación (Mineduc) para que puedas dar el siguiente paso en tu formación. Esta guía te ayudará a entender los distintos beneficios disponibles para el año académico 2025.</p>

                <div class="highlight">
                    <h2>Puntos Clave para Postular:</h2>
                    <ul>
                        <li>La mayoría de las becas se postulan a través del <a href="https://fuas.cl/" target="_blank">Formulario Único de Acreditación Socioeconómica (FUAS)</a>.</li>
                        <li>Es fundamental tener tu <a href="https://www.registrosocial.gob.cl/" target="_blank">Registro Social de Hogares (RSH)</a> actualizado.</li>
                        <li>Las fechas de postulación son publicadas anualmente por el Mineduc. Revisa constantemente el portal de Beneficios Estudiantiles.</li>
                        <li>La acreditación de la institución y/o carrera es un requisito común.</li>
                    </ul>
                </div>

                <h2>Becas de Arancel del Mineduc</h2>

                <div class="beca-item">
                    <div class="beca-header" onclick="toggleBeca(this)">
                        <h3>Gratuidad</h3>
                        <span class="toggle-icon">+</span>
                    </div>
                    <div class="beca-content">
                        <p><strong>Descripción:</strong> Cubre el 100% del arancel y la matrícula de la carrera, para estudiantes que cumplan con los requisitos socioeconómicos y se matriculen en una institución adscrita.</p>
                        <p><strong>Requisitos principales:</strong></p>
                        <ul>
                            <li>Pertenecer al 60% de los hogares de menores ingresos según el RSH.</li>
                            <li>Estar matriculado en una institución de educación superior adscrita a la Gratuidad.</li>
                            <li>Ser chileno o extranjero con permanencia definitiva/residencia y enseñanza media completa en Chile.</li>
                            <li>No haber excedido la duración formal de la carrera (para estudiantes de cursos superiores).</li>
                        </ul>
                        <p><strong>Monto:</strong> Cubre el 100% del arancel y matrícula referencial.</p>
                        <p><strong>Compatibilidad:</strong> No es compatible con otras becas de arancel del Mineduc.</p>
                    </div>
                </div>

                <div class="beca-item">
                    <div class="beca-header" onclick="toggleBeca(this)">
                        <h3>Beca Bicentenario (BB)</h3>
                        <span class="toggle-icon">+</span>
                    </div>
                    <div class="beca-content">
                        <p><strong>Descripción:</strong> Apoya el pago de tu carrera en universidades con al menos cuatro años de acreditación.</p>
                        <p><strong>Requisitos principales:</strong></p>
                        <ul>
                            <li>Pertenecer al 70% de la población de menores ingresos según el RSH.</li>
                            <li>Haber obtenido 500 puntos o más en la PAES (o PSU/PDT).</li>
                            <li>Para renovantes: 60% de ramos aprobados en 1er año, 70% desde 2do año.</li>
                            <li>No tener un título profesional o técnico superior.</li>
                        </ul>
                        <p><strong>Monto:</strong> Hasta el 100% del arancel de referencia (varía entre $500.000 y el arancel de referencia máximo).</p>
                    </div>
                </div>

                <div class="beca-item">
                    <div class="beca-header" onclick="toggleBeca(this)">
                        <h3>Beca Nuevo Milenio (BNM)</h3>
                        <span class="toggle-icon">+</span>
                    </div>
                    <div class="beca-content">
                        <p><strong>Descripción:</strong> Financia carreras técnico profesionales en CFT o IP acreditados.</p>
                        <p><strong>Requisitos principales:</strong></p>
                        <ul>
                            <li>Pertenecer al 70% de la población de menores ingresos según el RSH.</li>
                            <li>Promedio NEM igual o superior a 5.0 (BNM I) o pertenecer a los deciles 5 y 6 (BNM II).</li>
                        </ul>
                        <p><strong>Monto:</strong> Hasta $600.000 (BNM I) o hasta $860.000 (BNM II) anuales.</p>
                    </div>
                </div>

                <div class="beca-item">
                    <div class="beca-header" onclick="toggleBeca(this)">
                        <h3>Beca Juan Gómez Millas (BJGM)</h3>
                        <span class="toggle-icon">+</span>
                    </div>
                    <div class="beca-content">
                        <p><strong>Descripción:</strong> Apoyo para financiar tus estudios en cualquier institución de educación superior acreditada.</p>
                        <p><strong>Requisitos principales:</strong></p>
                        <ul>
                            <li>Pertenecer al 70% de la población de menores ingresos según el RSH.</li>
                            <li>Haber obtenido 500 puntos o más en la PAES (o PSU/PDT).</li>
                            <li>No tener un título profesional o técnico superior.</li>
                        </ul>
                        <p><strong>Monto:</strong> Hasta $1.150.000 anuales.</p>
                    </div>
                </div>

                <div class="beca-item">
                    <div class="beca-header" onclick="toggleBeca(this)">
                        <h3>Beca Vocación de Profesor (BVP)</h3>
                        <span class="toggle-icon">+</span>
                    </div>
                    <div class="beca-content">
                        <p><strong>Descripción:</strong> Cubre el costo total de la carrera de Pedagogía. Varias modalidades:</p>
                        <ul>
                            <li><strong>BVP Pedagogías:</strong> Para estudiantes que ingresan a Pedagogía con alto puntaje PAES (más de 625 puntos).</li>
                            <li><strong>BVP Licenciados y Profesionales:</strong> Para quienes ya tienen un título y quieren formarse como docentes.</li>
                            <li><strong>BVP Licenciaturas:</strong> Para estudiantes renovantes que continúan su formación pedagógica desde una licenciatura.</li>
                        </ul>
                        <p><strong>Monto:</strong> Cubre el costo total de la carrera.</p>
                    </div>
                </div>

                <div class="beca-item">
                    <div class="beca-header" onclick="toggleBeca(this)">
                        <h3>Beca Distinción a las Trayectorias Educativas (DTE)</h3>
                        <span class="toggle-icon">+</span>
                    </div>
                    <div class="beca-content">
                        <p><strong>Descripción:</strong> Para estudiantes que obtuvieron una de las Distinciones a las Trayectorias Educativas (DTE) en la PAES.</p>
                        <p><strong>Requisitos:</strong> Haber obtenido una DTE en la PAES.</p>
                        <p><strong>Monto:</strong> Financiamiento del arancel de la carrera.</p>
                    </div>
                </div>

                <div class="beca-item">
                    <div class="beca-header" onclick="toggleBeca(this)">
                        <h3>Beca Excelencia Académica (BEA)</h3>
                        <span class="toggle-icon">+</span>
                    </div>
                    <div class="beca-content">
                        <p><strong>Descripción:</strong> Para estudiantes con las notas más altas de su generación en la enseñanza media.</p>
                        <p><strong>Requisitos:</strong> Pertenecer al 80% de la población de menores ingresos y tener un NEM destacado.</p>
                        <p><strong>Monto:</strong> Varía, ayuda a financiar el arancel.</p>
                    </div>
                </div>

                <div class="beca-item">
                    <div class="beca-header" onclick="toggleBeca(this)">
                        <h3>Beca Excelencia Técnica (BET)</h3>
                        <span class="toggle-icon">+</span>
                    </div>
                    <div class="beca-content">
                        <p><strong>Descripción:</strong> Apoya a los mejores egresados de Enseñanza Media que ingresan a carreras técnico profesionales.</p>
                        <p><strong>Requisitos:</strong> Pertenecer al 80% de la población de menores ingresos y tener un NEM destacado.</p>
                        <p><strong>Monto:</strong> Varía.</p>
                    </div>
                </div>

                <div class="beca-item">
                    <div class="beca-header" onclick="toggleBeca(this)">
                        <h3>Beca para Hijas e Hijos de Profesionales de la Educación (BHP)</h3>
                        <span class="toggle-icon">+</span>
                    </div>
                    <div class="beca-content">
                        <p><strong>Descripción:</strong> Para hijos e hijas de profesionales o asistentes de la educación.</p>
                        <p><strong>Requisitos:</strong> Ser hijo/a de profesional o asistente docente con contrato vigente, pertenecer al 80% de menores ingresos, y obtener 500 puntos o más en la PAES (o PSU/PDT).</p>
                        <p><strong>Monto:</strong> Hasta $500.000 anuales.</p>
                    </div>
                </div>

                <div class="beca-item">
                    <div class="beca-header" onclick="toggleBeca(this)">
                        <h3>Beca de Articulación</h3>
                        <span class="toggle-icon">+</span>
                    </div>
                    <div class="beca-content">
                        <p><strong>Descripción:</strong> Para quienes tienen un título técnico y desean obtener un título profesional en la misma área.</p>
                        <p><strong>Requisitos:</strong> Tener título técnico de nivel superior, pertenecer al 70% de menores ingresos, y matricularse en carrera profesional afín.</p>
                        <p><strong>Monto:</strong> Varía.</p>
                    </div>
                </div>

                <div class="beca-item">
                    <div class="beca-header" onclick="toggleBeca(this)">
                        <h3>Beca para Estudiantes en Situación de Discapacidad</h3>
                        <span class="toggle-icon">+</span>
                    </div>
                    <div class="beca-content">
                        <p><strong>Descripción:</strong> Beca especial para estudiantes en situación de discapacidad.</p>
                        <p><strong>Requisitos:</strong> Contar con certificado de discapacidad del RND y cumplir requisitos generales.</p>
                        <p><strong>Monto:</strong> Varía.</p>
                    </div>
                </div>

                <div class="beca-item">
                    <div class="beca-header" onclick="toggleBeca(this)">
                        <h3>Becas de Reparación (Valech I y Valech II)</h3>
                        <span class="toggle-icon">+</span>
                    </div>
                    <div class="beca-content">
                        <p><strong>Descripción:</strong> Para personas en el listado de la Comisión Valech o sus descendientes directos.</p>
                        <p><strong>Requisitos:</strong> Estar en el listado Valech o ser hijo/a/nieto/a de alguien en el listado.</p>
                        <p><strong>Monto:</strong> Cubre el 100% del arancel y matrícula.</p>
                    </div>
                </div>

                <h2>Otros Beneficios Estudiantiles</h2>

                <div class="beca-item">
                    <div class="beca-header" onclick="toggleBeca(this)">
                        <h3>Fondo Solidario de Crédito Universitario (FSCU)</h3>
                        <span class="toggle-icon">+</span>
                    </div>
                    <div class="beca-content">
                        <p><strong>Descripción:</strong> Crédito para estudiantes de universidades del Consejo de Rectores.</p>
                        <p><strong>Requisitos:</strong> Pertenecer a los deciles 1 al 8 de ingreso y cumplir con requisitos académicos. Se postula vía FUAS.</p>
                    </div>
                </div>

                <div class="beca-item">
                    <div class="beca-header" onclick="toggleBeca(this)">
                        <h3>Crédito con Garantía Estatal (CAE)</h3>
                        <span class="toggle-icon">+</span>
                    </div>
                    <div class="beca-content">
                        <p><strong>Descripción:</strong> Crédito para financiar estudios en instituciones acreditadas, gestionado por la Comisión Ingresa.</p>
                        <p><strong>Requisitos:</strong> Postulación a través del sitio de Ingresa.cl.</p>
                    </div>
                </div>

                <div class="beca-item">
                    <div class="beca-header" onclick="toggleBeca(this)">
                        <h3>Becas JUNAEB (Mantención y Alimentación)</h3>
                        <span class="toggle-icon">+</span>
                    </div>
                    <div class="beca-content">
                        <p><strong>Descripción:</strong> Aportes económicos para gastos de mantención y alimentación.</p>
                        <ul>
                            <li><strong>Beca de Alimentación para la Educación Superior (BAES):</strong> Tarjeta para comprar alimentos.</li>
                            <li><strong>Beca Indígena (BI):</strong> Para estudiantes de ascendencia indígena.</li>
                            <li><strong>Beca Presidente de la República (BPR):</strong> Para estudiantes con alto rendimiento y bajos recursos.</li>
                            <li><strong>Beca de Mantención para la Educación Superior (BMES):</strong> Aporte en dinero para gastos de mantención.</li>
                        </ul>
                        <p><strong>Postulación:</strong> Generalmente se postulan y/o renuevan a través del Portal de Becas JUNAEB (<a href="https://portalbecas.junaeb.cl/" target="_blank">portalbecas.junaeb.cl</a>).</p>
                    </div>
                </div>

                <h2>¿Cómo Postular?</h2>
                <p>El proceso de postulación a la mayoría de las becas y beneficios del Mineduc comienza con el llenado del <a href="https://fuas.cl/" target="_blank">Formulario Único de Acreditación Socioeconómica (FUAS)</a> en los períodos que el Mineduc define anualmente.</p>
                <p>Una vez completado el FUAS, el Mineduc realiza la preselección y asignación de los beneficios. Es importante estar atento a los resultados y, si es necesario, a los períodos de apelación.</p>

                <h2>Más Información y Contacto</h2>
                <p>Para información oficial y actualizada sobre fechas, requisitos específicos y el estado de tu postulación, te recomiendo visitar los siguientes sitios web:</p>
                <ul>
                    <li><a href="https://portal.beneficiosestudiantiles.cl/" target="_blank">Portal de Beneficios Estudiantiles (Mineduc)</a></li>
                    <li><a href="https://fuas.cl/" target="_blank">FUAS.cl</a></li>
                    <li>Call Center Ayuda Mineduc: <strong>600 600 2626</strong></li>
                    <li><a href="https://www.junaeb.cl/" target="_blank">JUNAEB.cl</a> (para becas de mantención y alimentación)</li>
                </ul>
            </section>

            <!-- Sección de Reportar Problema - INTEGRADA DESDE PROBLEMA.HTML -->
            <section id="report-issue-section" class="content-section">
                <button class="back-button" data-target-section="modules">Volver</button>
                <div class="report-problem-container">
                    <h1><i class="fas fa-exclamation-triangle"></i> Reportar un Problema</h1>

                    <form id="reportIssueForm">
                        <div class="form-group">
                            <label for="nombreEstudiante">Tu Nombre:</label>
                            <input type="text" id="nombreEstudiante" name="nombreEstudiante" placeholder="Ej: Juan Pérez" required>
                        </div>

                        <div class="form-group">
                            <label for="carreraEstudiante">Tu Carrera:</label>
                            <select id="carreraEstudiante" name="carreraEstudiante" required>
                                <option value="">-- Selecciona tu Carrera --</option>
                                <option value="Programacion y Data Science">Programación y Data Science</option>
                                <option value="Enfermeria">Enfermería</option>
                                <option value="Podologia">Podología</option>
                                <option value="Administracion">Administración</option>
                                <option value="Electricidad">Electricidad</option>
                                <option value="Construccion">Construcción</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="profesorCarrera">Nombre del Profesor</label>
                            <input type="text" id="profesorCarrera" name="profesorCarrera" placeholder="Opcional">
                        </div>

                        <div class="form-group">
                            <label for="motivoReporte">Describe el Problema:</label>
                            <textarea id="motivoReporte" name="motivoReporte" rows="5" placeholder="Explica detalladamente el problema que deseas reportar..." required></textarea>
                        </div>

                        <button type="submit" id="submitReportBtn"><i class="fas fa-paper-plane"></i> Enviar Reporte</button>

                        <div id="formMessage" class="message"></div>
                    </form>
                </div>
            </section>

        <!-- Sección de Admisión - NUEVA E INTEGRADA -->
        <section id="admision-section" class="content-section">
            <button class="back-button" data-target-section="modules">Volver</button>
            <div class="form-container" style="background-color: rgba(255, 255, 255, 0.95); margin-top: 20px;">
                <h2>¿Qué carrera te interesa?</h2>
                <div class="divider"></div>
                <form id="admisionForm" action="#" method="POST">
                    <div class="form-fields">
                        <div class="input-group">
                            <label for="admision-nombre">Nombre *</label>
                            <input type="text" id="admision-nombre" name="nombre" required>
                        </div>
                        <div class="input-group">
                             <label for="admision-sede">Selecciona una Sede *</label>
                            <select id="admision-sede" name="sede" required>
                                <option value="" disabled selected>-- Elige una sede --</option>
                                <option value="valdivia">Sede Valdivia</option>
                                <option value="launion">Sede La Unión</option>
                                <option value="paillaco">Sede Paillaco</option>
                                <option value="panguipulli">Sede Panguipulli</option>
                            </select>
                        </div>
                        <div class="input-group">
                            <label for="admision-apellido">Apellido *</label>
                            <input type="text" id="admision-apellido" name="apellido" required>
                        </div>
                        <div class="input-group">
                             <label for="admision-carrera">Selecciona una Carrera *</label>
                            <select id="admision-carrera" name="carrera" required disabled>
                                <option value="" disabled selected>-- Primero elige una sede --</option>
                            </select>
                        </div>
                        <div class="input-group">
                            <label for="admision-telefono">Teléfono *</label>
                            <input type="tel" id="admision-telefono" name="telefono" required>
                        </div>
                        <div class="input-group">
                            <label for="admision-email">Email *</label>
                            <input type="email" id="admision-email" name="email" required>
                        </div>
                         <button type="submit" class="submit-button">Enviar Info</button>
                    </div>
                </form>
            </div>
            <!-- El icono de WhatsApp se omite aquí para mantener la consistencia del portal,
                 podría añadirse globalmente si se desea -->
        </section>

        <!-- Sección de Vida Estudiantil - NUEVA E INTEGRADA -->
        <section id="vida-estudiantil-section" class="content-section">
            <button class="back-button" data-target-section="modules">Volver</button>
            <h1 class="section-title">Vida Estudiantil</h1> <!-- Título principal de la sección -->
            <p style="text-align: center; color: var(--color-texto); margin-bottom: var(--espaciado-lg);">Tu experiencia más allá de la sala de clases.</p>

            <div class="vida-estudiantil-content-wrapper"> <!-- Wrapper para aplicar estilos del main de vida_estudiantil.html -->
                <section id="actividades-vida"> <!-- ID cambiado para evitar colisión con #actividades si existiera -->
                    <h2>Actividades y Talleres</h2>
                    <p>Descubre los clubes y talleres que tenemos para ti. ¡Participa y desarrolla nuevas habilidades!</p>
                    <div class="grid-container">
                        <div class="card">
                            <h3>Club de Programación</h3>
                            <p>Un espacio para aprender y desarrollar proyectos con otros estudiantes interesados en la tecnología.</p>
                            <a href="#">Más información</a>
                        </div>
                        <div class="card">
                            <h3>Taller de Fotografía</h3>
                            <p>Captura los mejores momentos del campus y aprende técnicas de edición profesional.</p>
                            <a href="#">Más información</a>
                        </div>
                        <div class="card">
                            <h3>Selección de Pin-Pon</h3>
                            <p>¡Únete al equipo y representa a nuestro CFT en torneos inter-instituciones!</p>
                            <a href="#">Más información</a>
                        </div>
                    </div>
                </section>

                <hr> 

                <section id="servicios-vida">  <!-- ID cambiado -->
                    <h2>Servicios Estudiantiles</h2>
                    <p>Conoce los servicios de apoyo que están a tu disposición para ayudarte durante tu formación.</p>
                    <div class="grid-container">
                        <div class="card">
                            <h3>Biblioteca</h3>
                            <p>Accede a nuestro catálogo de libros, salas de estudio y recursos en línea.</p>
                            <a href="#">Ver horarios</a>
                        </div>
                        <div class="card">
                            <h3>Apoyo Académico</h3>
                            <p>Recibe tutorías y orientación para las asignaturas que necesites.</p>
                            <a href="#">Solicitar tutoría</a>
                        </div>
                        <div class="card">
                            <h3>Salud y Bienestar</h3>
                            <p>Información sobre atención médica y apoyo psicológico.</p>
                            <a href="#">Conoce los servicios</a>
                        </div>
                    </div>
                </section>

                <hr>

                <section id="galeria-vida"> <!-- ID cambiado -->
                    <h2>Galería de Fotos</h2>
                    <p>Revive los mejores momentos de nuestra comunidad estudiantil.</p>
                    <div class="gallery">
                        <img src="https://www.astex.es/wp-content/uploads/2023/01/graduacion-en-estados-unidos.jpg.webp" alt="Foto de graduación">
                        <img src="https://www.diariopaillaco.cl/files/files/20241123_161041.jpg" alt="Foto de torneo deportivo">
                        <img src="https://portaleduca.cl/wp-content/uploads/2023/03/Inauguracion-Talleres-de-robotica-y-Clubes-de-Ciencia-y-Tecnologia-de-Fundacion-Mustakis.jpg" alt="Foto de taller de robótica">
                        <img src="https://www.rln.cl/wp-content/uploads/2022/05/WhatsApp-Image-2022-05-14-at-12.39.57-PM-1.jpeg" alt="Foto del día del estudiante">
                    </div>
                </section>

                <hr>

                <section id="enlaces-vida"> <!-- ID cambiado -->
                    <h2>Enlaces de Interés</h2>
                    <p>Accede rápidamente a las plataformas y recursos que más utilizas.</p>
                    <ul>
                        <li><a href="#">Portal del Estudiante</a></li>
                        <li><a href="#">Correo Institucional</a></li>
                        <li><a href="#">Plataforma de Estudios (Moodle/Blackboard)</a></li>
                        <li><a href="#">Redes Sociales del CFT</a></li>
                    </ul>
                </section>

                <hr>

                <section id="faq-vida"> <!-- ID cambiado -->
                    <h2>Preguntas Frecuentes (FAQ)</h2>
                    <p>Encuentra respuestas a las dudas más comunes de los estudiantes.</p>
                    <div class="faq-item">
                        <h3>¿Cómo solicito un certificado de alumno regular?</h3>
                        <p>Puedes solicitarlo a través de tu Portal del Estudiante, en la sección de "Trámites".</p>
                    </div>
                    <div class="faq-item">
                        <h3>¿Cómo me inscribo en un taller?</h3>
                        <p>Las inscripciones se realizan de manera online en el apartado de Actividades Estudiantiles. Se anuncian con anticipación en la página web.</p>
                    </div>
                </section>
            </div>
        </section>

        <!-- Sección de Noticias - NUEVA E INTEGRADA -->
        <section id="noticias-section" class="content-section">
            <button class="back-button" data-target-section="modules">Volver</button>
            
            <!-- Contenido adaptado de noticias.html -->
            <div class="noticias-header-container"> <!-- Cambiado de header-container para evitar colisión de estilos globales -->
                <div class="container"> <!-- Este container es de Bootstrap, podría necesitar adaptación o ser eliminado si index.html no usa Bootstrap globalmente -->
                    <div class="text-center">
                        <div class="logo-container">
                            <img src="https://scontent.fscl1-1.fna.fbcdn.net/v/t39.30808-6/461394050_983690777101439_5539481001180531299_n.jpg?_nc_cat=108&ccb=1-7&_nc_sid=6ee11a&_nc_ohc=thyOST8Gj1gQ7kNvwEICK7j&_nc_oc=Adkg1EDOuG9UdJhRHPnewfWPIuy0rEnvHuoY6lV6M6G0r4Wo3tlJ875EXHiVJtvaGt4&_nc_zt=23&_nc_ht=scontent.fscl1-1.fna&_nc_gid=zj4fJnvaHahQX9u9IOXSsg&oh=00_AfPT8U-jbsU8hDmtg4BxRauPFiPRU6ah9Wz7dOXhD2j63A&oe=6863453C" alt="Logo CFT Los Ríos">
                        </div>
                        <h1 class="header-title">CFT Los Ríos</h1> <!-- Esta clase podría necesitar adaptación -->
                        <p class="header-subtitle">Noticias de nuestros campus y actividades académicas</p>
                    </div>
                </div>
            </div>

            <div class="container"> <!-- Este container es de Bootstrap -->
                <div class="filter-container">
                    <p class="filter-title">Filtrar noticias por campus:</p>
                    <!-- Los botones de filtro usarán clases de Bootstrap si están disponibles, o se estilizarán manualmente -->
                    <div class="d-flex flex-wrap justify-content-center"> 
                        <button class="filter-btn" data-filter="all">Todos</button>
                        <button class="filter-btn" data-filter="valdivia">Valdivia</button>
                        <button class="filter-btn" data-filter="paillaco">Paillaco</button>
                        <button class="filter-btn" data-filter="panguipulli">Panguipulli</button>
                        <button class="filter-btn" data-filter="la-union">La Unión</button>
                    </div>
                </div>

                <div class="noticias-main-container"> <!-- Cambiado de main-container -->
                    <div class="news-container">
                        <div class="news-row g-4"> <!-- Reemplaza row de Bootstrap con una clase personalizada -->
                            <!-- Noticia 1 - Valdivia -->
                            <div class="news-col news-card valdivia">  <!-- Reemplaza col-md-6 col-lg-4 -->
                                <img src="https://images.unsplash.com/photo-1523580494863-6f3031224c94?auto=format&fit=crop&w=600&q=80" class="card-img-top" alt="Laboratorio Valdivia">
                                <div class="category-tag">Valdivia</div>
                                <div class="card-body">
                                    <div class="card-date"><i class="far fa-calendar"></i> 15 Octubre 2023</div>
                                    <h5 class="card-title">Nuevo laboratorio tecnológico en Valdivia</h5>
                                    <p class="card-text">Equipamiento de última generación para estudiantes de informática y telecomunicaciones. El espacio cuenta con tecnología de punta para prácticas avanzadas.</p>
                                    <a href="#" class="read-more">Leer más <i class="fas fa-arrow-right"></i></a>
                                </div>
                            </div>
                            
                            <!-- Noticia 2 - Paillaco -->
                            <div class="news-col news-card paillaco">
                                <img src="https://images.unsplash.com/photo-1555939594-58d7cb561ad1?auto=format&fit=crop&w=600&q=80" class="card-img-top" alt="Gastronomía Paillaco">
                                <div class="category-tag">Paillaco</div>
                                <div class="card-body">
                                    <div class="card-date"><i class="far fa-calendar"></i> 12 Octubre 2023</div>
                                    <h5 class="card-title">Exitosa feria gastronómica en Paillaco</h5>
                                    <p class="card-text">Evento reunió a más de 500 personas y mostró la diversidad culinaria regional. Estudiantes de gastronomía presentaron innovadoras propuestas.</p>
                                    <a href="#" class="read-more">Leer más <i class="fas fa-arrow-right"></i></a>
                                </div>
                            </div>
                            
                            <!-- Noticia 3 - Panguipulli -->
                            <div class="news-col news-card panguipulli">
                                <img src="https://images.unsplash.com/photo-1448375240586-882707db888b?auto=format&fit=crop&w=600&q=80" class="card-img-top" alt="Forestal Panguipulli">
                                <div class="category-tag">Panguipulli</div>
                                <div class="card-body">
                                    <div class="card-date"><i class="far fa-calendar"></i> 8 Octubre 2023</div>
                                    <h5 class="card-title">Convenio con empresas forestales</h5>
                                    <p class="card-text">Acuerdo beneficiará a estudiantes de Técnico Forestal con prácticas profesionales. La alianza incluye programas de capacitación continua.</p>
                                    <a href="#" class="read-more">Leer más <i class="fas fa-arrow-right"></i></a>
                                </div>
                            </div>
                            
                            <!-- Noticia 4 - La Unión -->
                            <div class="news-col news-card la-union">
                                <img src="https://images.unsplash.com/photo-1581091226033-d5c48150dbaa?auto=format&fit=crop&w=600&q=80" class="card-img-top" alt="Robótica La Unión">
                                <div class="category-tag">La Unión</div>
                                <div class="card-body">
                                    <div class="card-date"><i class="far fa-calendar"></i> 5 Octubre 2023</div>
                                    <h5 class="card-title">Destacan en competencia de robótica</h5>
                                    <p class="card-text">Equipo obtuvo segundo lugar con proyecto de automatización agrícola. El desarrollo busca optimizar procesos en cultivos regionales.</p>
                                    <a href="#" class="read-more">Leer más <i class="fas fa-arrow-right"></i></a>
                                </div>
                            </div>
                            
                            <!-- Noticia 5 - General -->
                            <div class="news-col news-card general">
                                <img src="https://images.unsplash.com/photo-1532629345422-7515f3d16bb6?auto=format&fit=crop&w=600&q=80" class="card-img-top" alt="Becas generales">
                                <div class="category-tag">General</div>
                                <div class="card-body">
                                    <div class="card-date"><i class="far fa-calendar"></i> 1 Octubre 2023</div>
                                    <h5 class="card-title">Nuevo programa de becas estudiantiles</h5>
                                    <p class="card-text">Ampliación de programa de apoyo para estudiantes de escasos recursos. Se beneficiarán más de 200 alumnos en toda la región.</p>
                                    <a href="#" class="read-more">Leer más <i class="fas fa-arrow-right"></i></a>
                                </div>
                            </div>
                            
                            <!-- Noticia 6 - Valdivia -->
                            <div class="news-col news-card valdivia">
                                <img src="https://images.unsplash.com/photo-1547891654-e66ed7ebb968?auto=format&fit=crop&w=600&q=80" class="card-img-top" alt="Arte Valdivia">
                                <div class="category-tag">Valdivia</div>
                                <div class="card-body">
                                    <div class="card-date"><i class="far fa-calendar"></i> 28 Septiembre 2023</div>
                                    <h5 class="card-title">Exposición de arte contemporáneo</h5>
                                    <p class="card-text">Muestra de trabajos de estudiantes de Diseño Gráfico abierta al público. La exposición estará disponible durante todo octubre.</p>
                                    <a href="#" class="read-more">Leer más <i class="fas fa-arrow-right"></i></a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        </div>
    </main>

    <footer>
            <p>&copy; 2025 Todos los derechos reservados.</p>
        </div>
    </footer>

    <!-- Modal de Detalles del Contacto (formato normal) - ACTUALIZADO -->
    <div id="contact-details-modal" class="modal">
        <div class="modal-content">
            <span class="close-button" id="close-contact-details-modal">&times;</span>
            <h2 id="contact-details-title"></h2>
            <div id="contact-details-output"></div>
        </div>
    </div>


    <div id="login-modal" class="modal">
        <!-- Contenido del modal de login, se cargará dinámicamente -->
        <div class="modal-content" id="loginContainerMain">
            <!-- El contenido se insertará aquí por JS -->
        </div>
    </div>
    
    <!-- Notificaciones, añadidas al body principal -->
    <div class="notification error" id="errorNotification">
        <i class="fas fa-exclamation-circle"></i>
        <span id="errorMessage"></span>
    </div>
    
    <div class="notification success" id="successNotification">
        <i class="fas fa-check-circle"></i>
        <span id="successMessage"></span>
    </div>

    <script>
        /*
           ====================================================================
           SECCIÓN: VARIABLES Y CONSTANTES GLOBALES
           Descripción: Declaración de todas las referencias a elementos del DOM
                        y valores constantes para fácil acceso y modificación.
           ====================================================================
        */
        // Users database (5 random users with @cftrl.cl emails and RUT passwords)
        // Estos son los datos de usuario "actualizados" que mencionaste.
        const users = [
            {
                name: "Henrry Alocilla",
                email: "henrryalocilla@cftlr.cl",
                password: "12345678-9"
            },
            {
                name: "Alex Reyes",
                email: "alexreyes@cftlr.cl",
                password: "16870931-5"
            },
            {
                name: "Renato Sandoval",
                email: "renatosandoval@cftlr.cl",
                password: "21638623-k" 
            },
            {
                name: "Diego Vergara",
                email: "diegovergara@cftlr.cl",
                password: "19764816-3"
            },
            {
                name: "Fernando Millapan",
                email: "fernandomillapan@cftlr.cl",
                password: "21596595-3"
            }
        ];

        // Directorio de contactos (NUEVO: organizado por sede y con datos de Paillaco actualizados)
        const directoryDataBySede = {
            "Sede Valdivia": [
                {
                    name: "Dr. Ana Rojas",
                    position: "Directora Académica",
                    email: "arojas@cftrl.cl",
                    phone: "+56 9 1111 2222",
                    department: "Administración",
                    icon: "&#127891;" // Icono de birrete
                },
                {
                    name: "Prof. Ricardo Soto",
                    position: "Jefe de Carrera (Programación)",
                    email: "rsoto@cftrl.cl",
                    phone: "+56 9 3333 4444",
                    department: "Informática",
                    icon: "&#128187;" // Icono de laptop
                }
            ],
            "Sede La Unión": [
                {
                    name: "Ing. Carla Fuentes",
                    position: "Coordinadora de Prácticas",
                    email: "cfuentes@cftrl.cl",
                    phone: "+56 9 5555 6666",
                    department: "Vinculación con el Medio",
                    icon: "&#128188;" // Icono de maletín
                },
                {
                    name: "Sra. Elena Paredes",
                    position: "Secretaria Académica",
                    email: "eparedes@cftrl.cl",
                    phone: "+56 9 7777 8888",
                    department: "Secretaría General",
                    icon: "&#128100;" // Icono de busto/persona
                }
            ],
            "Sede Paillaco": [ // Datos actualizados
                {
                    name: "Mauricio Peters",
                    position: "Coordinador Sede",
                    email: "mpeters@cftdelosrios.cl",
                    phone: "+56 9 2100 0001", // Teléfono ficticio
                    department: "Coordinación",
                    icon: "&#128204;" // Icono de pin de mapa
                },
                {
                    name: "Abraham Acevedo",
                    position: "Registro Curricular",
                    email: "aacevedo@cftdelosrios.cl",
                    phone: "+56 9 2100 0002", // Teléfono ficticio
                    department: "Académico",
                    icon: "&#128220;" // Icono de notas
                },
                {
                    name: "Felipe Fierro",
                    position: "Experiencia Estudiantil",
                    email: "ffierro@cftdelosrios.cl",
                    phone: "+56 9 2100 0003", // Teléfono ficticio
                    department: "DAE",
                    icon: "&#128100;" // Icono de persona
                },
                {
                    name: "Scarlett Barra",
                    position: "Psicóloga",
                    email: "sbarra@cftdelosrios.cl",
                    phone: "+56 9 2100 0004", // Teléfono ficticio
                    department: "Equipo Psicosocial",
                    icon: "&#129504;" // Icono de cerebro
                },
                {
                    name: "María José Pardo",
                    position: "Psicopedagoga",
                    email: "mpardo@cftdelosrios.cl",
                    phone: "+56 9 2100 0005", // Teléfono ficticio
                    department: "Equipo Psicosocial",
                    icon: "&#128218;" // Icono de libro
                },
                {
                    name: "Camila Donoso",
                    position: "Admisión",
                    email: "cdonoso@cftdelosrios.cl",
                    phone: "+56 9 2100 0006", // Teléfono ficticio
                    department: "Admisión",
                    icon: "&#128273;" // Icono de llave
                }
            ]
        };


        // Elementos de navegación
        const menuToggle = document.querySelector('.menu-toggle');
        const navUl = document.querySelector('nav ul');
        const profileNavLink = document.getElementById('profile-nav-link');
        const carrerasNavLink = document.getElementById('carreras-nav-link'); 
        const admisionNavLink = document.getElementById('admision-nav-link'); 
        const vidaEstudiantilNavLink = document.getElementById('vida-estudiantil-nav-link'); 
        const noticiasNavLink = document.getElementById('noticias-nav-link'); 
        const themeToggleButton = document.getElementById('theme-toggle-button'); 
        const navSearchInput = document.getElementById('nav-search-input'); // Input de búsqueda
        const navSearchButton = document.getElementById('nav-search-button'); // Botón de búsqueda
        const navSearchLi = document.getElementById('nav-search-li'); // Elemento <li> de la búsqueda para visibilidad
        const navProfilePic = document.getElementById('nav-profile-pic');

        // Elementos de contenido y secciones
        const allContentSections = document.querySelectorAll('.content-section, .modules-grid');
        const homeSection = document.getElementById('home-section');
        const modulesSection = document.getElementById('modules-section');
        const userProfileDetailSection = document.getElementById('user-profile-detail-section');
        const directorySection = document.getElementById('directory-section'); 
        const notesAttendanceSection = document.getElementById('notes-attendance-section'); 
        const academicCalendarSection = document.getElementById('academic-calendar-section'); 
        const notificationsSection = document.getElementById('notifications-section'); 
        const scholarshipsSection = document.getElementById('scholarships-section'); 
        const reportIssueSection = document.getElementById('report-issue-section'); 
        const admisionSection = document.getElementById('admision-section'); 
        const vidaEstudiantilSection = document.getElementById('vida-estudiantil-section'); 
        const noticiasSection = document.getElementById('noticias-section'); // NUEVO: Sección Noticias
        const backButtons = document.querySelectorAll('.back-button');

        // Elementos del Modal de Autenticación (actualizados para el nuevo login)
        const loginModal = document.getElementById('login-modal');
        const closeModalButton = document.querySelector('.close-button');
        const modalTitle = document.getElementById('modal-title'); // Título dentro del login-header
        const authForm = document.getElementById('auth-form'); // El formulario principal del login
        const emailInput = document.getElementById('email'); // Campo de email del nuevo login
        const passwordInput = document.getElementById('password'); // Campo de contraseña del nuevo login
        const loginBtn = document.getElementById('loginBtn'); // Botón de login del nuevo login
        const modalToggleFormLink = document.getElementById('modal-toggle-form'); // Enlace para alternar entre login/registro
        const loginContainerMain = document.getElementById('loginContainerMain'); // El contenedor principal del formulario de login para animaciones
        
        // Elementos de Notificación (del nuevo login)
        const errorNotification = document.getElementById('errorNotification');
        const successNotification = document.getElementById('successNotification');
        const errorMessageSpan = document.getElementById('errorMessage');
        const successMessageSpan = document.getElementById('successMessage');

        // Elementos del Dropdown de Perfil (en Header)
        const profileDropdown = document.getElementById('profile-dropdown');
        const dropdownProfilePic = document.getElementById('dropdown-profile-pic');
        const dropdownUsername = document.getElementById('dropdown-username');

        // Elementos de la sección de Perfil Detallado
        const profileForm = document.getElementById('profile-form');
        const profilePic = document.getElementById('profile-pic');
        const profileImageUpload = document.getElementById('profile-image-upload');
        const deleteProfilePicBtn = document.getElementById('delete-profile-pic-btn');
        const profileNameInput = document.getElementById('profile-name');
        const profileEmailInput = document.getElementById('profile-email');
        const profilePhoneInput = document.getElementById('profile-phone');
        const profileRutInput = document.getElementById('profile-rut');
        const editProfileBtn = document.getElementById('edit-profile-btn');
        const saveProfileBtn = document.getElementById('save-profile-btn');
        const cancelEditBtn = document.getElementById('cancel-edit-btn');
        const profileMessage = document.getElementById('profile-message');

        // Elementos del Formulario de Notificaciones
        const notificationForm = document.getElementById('notificationForm');
        const emailNotificationInput = document.getElementById('email_notification');
        const phoneNotificationInput = document.getElementById('phone_notification');
        const messageNotificationInput = document.getElementById('message_notification');
        const responseMessageNotificationDiv = document.getElementById('responseMessageNotification');

        // Elementos del Directorio (NUEVOS)
        const directoryList = document.getElementById('directory-list');
        const contactDetailsModal = document.getElementById('contact-details-modal');
        const closeContactDetailsModalBtn = document.getElementById('close-contact-details-modal');
        const contactDetailsTitle = document.getElementById('contact-details-title');
        const contactDetailsOutput = document.getElementById('contact-details-output');

        // Elementos del Formulario de Reportar Problemas (NUEVOS - desde problema.html)
        const reportIssueForm = document.getElementById('reportIssueForm');
        const formMessage = document.getElementById('formMessage'); // Mensaje dentro del formulario de reporte
        const submitReportBtn = document.getElementById('submitReportBtn');


        // Constantes
        const DEFAULT_AVATAR_PATH = 'https://placehold.co/120x120/D3D3D3/000?text=Avatar'; // Ruta a una imagen de avatar por defecto
        let isRegistering = false; // Estado para el formulario de autenticación (registro vs. login)


        /*
           ====================================================================
           SECCIÓN: FUNCIONES DE UTILIDAD (HELPERS)
           Descripción: Funciones genéricas y reutilizables para tareas comunes.
           ====================================================================
        */

        /**
         * Obtiene el valor de una variable CSS definida en :root.
         * @param {string} variableName - El nombre de la variable CSS (ej. '--color-primario').
         * @returns {string} El valor de la variable CSS.
         */
        function getCssVariable(variableName) {
            return getComputedStyle(document.documentElement).getPropertyValue(variableName).trim();
        }

        /**
         * Oculta todas las secciones de contenido activas.
         */
        function hideAllSections() {
            allContentSections.forEach(section => {
                section.classList.remove('active-section');
            });
        }

        /**
         * Muestra una sección específica y oculta las demás.
         * Realiza comprobaciones de autenticación para secciones protegidas.
         * @param {string} sectionId - El ID de la sección a mostrar (sin '-section', ej. 'home', 'modules').
         */
        function showSection(sectionId) {
            const loggedInUser = localStorage.getItem('currentUserEmail');
            const protectedSections = ['user-profile-detail', 'notes-attendance', 'academic-calendar', 'notifications', 'directory', 'scholarships', 'report-issue'];

            // Lógica para el logo (si se hace clic en él)
            if (sectionId === 'main-menu') {
                sectionId = loggedInUser ? 'modules' : 'home';
            }

            // Redirige a login si intenta acceder a una sección protegida sin autenticación
            if (protectedSections.includes(sectionId) && !loggedInUser) {
                hideAllSections();
                homeSection.classList.add('active-section');
                openLoginModal();
                showNotification('error', 'Debes iniciar sesión para acceder a esta función.');
                return;
            }

            hideAllSections(); // Oculta todas antes de mostrar la deseada

            const targetSectionElement = document.getElementById(`${sectionId}-section`);
            if (targetSectionElement) {
                targetSectionElement.classList.add('active-section');
                // Si la sección es el directorio, renderiza la lista
                if (sectionId === 'directory') {
                    renderDirectory();
                } else if (sectionId === 'notes-attendance') { // NUEVO: Inicializa la sección de notas
                    initializeNotesSection();
                } else if (sectionId === 'scholarships') { // NUEVO: Inicializa la sección de becas
                    // No hay lógica JS compleja para la sección de becas, solo asegura que los enlaces toggleBeca funcionen.
                    // La función toggleBeca ya está globalmente disponible, por lo que no se necesita una llamada de inicialización específica aquí.
                } else if (sectionId === 'report-issue') { // NUEVO: para el formulario de reporte de problemas
                    // Puedes añadir lógica específica si es necesario al mostrar esta sección
                }
            }

            // Asegura que la sección de módulos se active solo cuando corresponde
            if (loggedInUser && sectionId === 'modules') {
                modulesSection.classList.add('active-section');
            } else {
                modulesSection.classList.remove('active-section');
            }

            // Carga datos del perfil si se va a la sección de detalles del perfil
            if (sectionId === 'user-profile-detail' && loggedInUser) {
                loadProfileData(loggedInUser);
                setProfileFormState(false); // Por defecto, el formulario de perfil está en modo de visualización
            }

            // Manejo de la visibilidad de los botones de retroceso
            backButtons.forEach(button => {
                const parentSection = button.closest('.content-section');
                if (parentSection) {
                    const parentSectionId = parentSection.id.replace('-section', '');
                    if (sectionId === parentSectionId && sectionId !== 'home' && sectionId !== 'modules') {
                        button.style.display = 'flex';
                    } else {
                        button.style.display = 'none';
                    }
                }
            });
        }

        /**
         * Muestra una notificación temporal en la esquina superior derecha.
         * @param {string} type - 'success' o 'error'.
         * @param {string} message - El mensaje a mostrar.
         */
        function showNotification(type, message) {
            const notificationElement = type === 'success' ? successNotification : errorNotification;
            const messageSpan = type === 'success' ? successMessageSpan : errorMessageSpan;

            // Hide the other notification if it's currently showing
            const otherNotification = type === 'success' ? errorNotification : successNotification;
            otherNotification.classList.remove('show');
            otherNotification.classList.remove(type === 'success' ? 'error' : 'success'); // Remove class to prevent conflicts

            messageSpan.textContent = message;
            notificationElement.classList.add('show');
            notificationElement.classList.add(type); // Add the specific type class

            setTimeout(() => {
                notificationElement.classList.remove('show');
                notificationElement.classList.remove(type); // Remove type class after hiding
            }, 3000); // Notification visible for 3 seconds
        }


        /**
         * Función para mostrar mensajes al usuario dentro del formulario de notificaciones.
         * @param {string} message - El mensaje a mostrar.
         * @param {string} type - 'success', 'error' o 'info'.
         */
        function showFormMessage(message, type) {
            responseMessageNotificationDiv.textContent = message;
            responseMessageNotificationDiv.classList.remove('hidden', 'bg-red-100', 'text-red-800', 'bg-green-100', 'text-green-800', 'bg-blue-100', 'text-blue-800');
            if (type === 'success') {
                responseMessageNotificationDiv.classList.add('bg-green-100', 'text-green-800');
            } else if (type === 'error') {
                responseMessageNotificationDiv.classList.add('bg-red-100', 'text-red-800');
            } else {
                responseMessageNotificationDiv.classList.add('bg-blue-100', 'text-blue-800');
            }
            // Muestra el mensaje
            responseMessageNotificationDiv.style.display = 'block';
            // Ocultar automáticamente mensajes de éxito/info después de 5 segundos
            if (type === 'success' || type === 'info') {
                setTimeout(() => {
                    responseMessageNotificationDiv.style.display = 'none';
                }, 5000);
            }
        }


        /**
         * Función para mostrar mensajes en el formulario de reporte de problemas.
         * Es una versión adaptada de showFormMessage para este formulario específico.
         * @param {string} message - El mensaje a mostrar.
         * @param {string} type - 'success', 'error' o 'info'.
         */
        function showReportFormMessage(message, type) {
            formMessage.textContent = message;
            formMessage.className = `message ${type}`; // Elimina clases anteriores y añade la nueva
            formMessage.style.display = 'block'; // Muestra el mensaje
            // Ocultar automáticamente mensajes de éxito/info después de 5 segundos
            if (type === 'success' || type === 'info') {
                setTimeout(() => {
                    formMessage.style.display = 'none';
                }, 5000);
            }
        }


        /*
           ====================================================================
           SECCIÓN: LÓGICA DE AUTENTICACIÓN Y MODAL
           Descripción: Funciones para abrir/cerrar el modal de login/registro,
                        gestionar el estado del formulario y manejar la autenticación.
           ====================================================================
        */

        /**
         * Abre el modal de inicio de sesión/registro.
         */
        function openLoginModal() {
            loginModal.classList.add('show');
            emailInput.value = '';
            passwordInput.value = '';
            setFormToLoginMode(); // Asegurarse de que el formulario empiece en modo login
        }

        /**
         * Cierra el modal de inicio de sesión/registro.
         */
        function closeLoginModal() {
            loginModal.classList.remove('show');
            // Ensure no lingering shake effect
            if (loginContainerMain.classList.contains('shake')) {
                loginContainerMain.classList.remove('shake');
            }
        }

        /**
         * Configura el formulario del modal en modo "Iniciar Sesión".
         */
        function setFormToLoginMode() {
            isRegistering = false;
            modalTitle.textContent = 'Intranet CFT Los Ríos'; // Título del nuevo login
            document.querySelector('.login-subtitle').textContent = 'Ingresa tus credenciales para acceder';
            loginBtn.querySelector('.btn-text').textContent = 'Iniciar Sesión';
            modalToggleFormLink.textContent = '¿No tienes cuenta? Regístrate aquí';
            // Clear any previous error messages
            errorMessageSpan.textContent = '';
            successMessageSpan.textContent = '';
            errorNotification.classList.remove('show');
            successNotification.classList.remove('show');
        }

        /**
         * Configura el formulario del modal en modo "Registrarse".
         */
        function setFormToRegisterMode() {
            isRegistering = true;
            modalTitle.textContent = 'Registrarse en CFT Los Ríos';
            document.querySelector('.login-subtitle').textContent = 'Crea tu cuenta para acceder';
            loginBtn.querySelector('.btn-text').textContent = 'Registrarse';
            modalToggleFormLink.textContent = 'Ya tengo cuenta, Iniciar Sesión';
            // Clear any previous error messages
            errorMessageSpan.textContent = '';
            successMessageSpan.textContent = '';
            errorNotification.classList.remove('show');
            successNotification.classList.remove('show');
        }

        /**
         * Muestra/oculta el spinner de carga en el botón de login.
         * @param {boolean} isLoading - True para mostrar, false para ocultar.
         */
        function setLoading(isLoading) {
            if (isLoading) {
                loginBtn.classList.add('loading');
                loginBtn.disabled = true;
            } else {
                loginBtn.classList.remove('loading');
                loginBtn.disabled = false;
            }
        }

        /**
         * Actualiza la interfaz de usuario de la barra de navegación en función del estado de autenticación.
         * Muestra/oculta el enlace de perfil y actualiza la foto/nombre.
         * También gestiona la visibilidad del botón de menú móvil.
         */
        function updateAuthUI() {
            const loggedInUser = localStorage.getItem('currentUserEmail');
            if (loggedInUser) {
                document.body.classList.add('logged-in');
                profileNavLink.style.display = 'list-item';
                carrerasNavLink.style.display = 'list-item';
                admisionNavLink.style.display = 'list-item'; 
                vidaEstudiantilNavLink.style.display = 'list-item'; 
                noticiasNavLink.style.display = 'list-item'; 
                navSearchLi.style.display = 'list-item'; // Mostrar contenedor de búsqueda

                const profile = getProfileData(loggedInUser);
                navProfilePic.src = profile.profilePic || DEFAULT_AVATAR_PATH;
                dropdownProfilePic.src = profile.profilePic || DEFAULT_AVATAR_PATH;
                dropdownUsername.textContent = profile.name || loggedInUser;
                showSection('modules');
            } else {
                document.body.classList.remove('logged-in');
                profileNavLink.style.display = 'none';
                carrerasNavLink.style.display = 'none';
                admisionNavLink.style.display = 'none'; 
                vidaEstudiantilNavLink.style.display = 'none'; 
                noticiasNavLink.style.display = 'none'; 
                navSearchLi.style.display = 'none'; // Ocultar contenedor de búsqueda
                profileDropdown.classList.remove('show');
                showSection('home');
            }
        }


        /*
           ====================================================================
           SECCIÓN: LÓGICA DE GESTIÓN DE PERFIL
           Descripción: Funciones para cargar, guardar y editar los datos del perfil,
                        incluyendo la foto de perfil.
           ====================================================================
        */

        /**
         * Obtiene los datos del perfil de un usuario del localStorage.
         * Si no existe, devuelve un perfil por defecto.
         * @param {string} email - El email del usuario.
         * @returns {object} Un objeto con los datos del perfil.
         */
        function getProfileData(email) {
            const profileKey = `profile_${email}`;
            const storedProfile = localStorage.getItem(profileKey);
            if (storedProfile) {
                return JSON.parse(storedProfile);
            } else {
                // Si el usuario existe en 'users' pero no tiene perfil en localStorage, creamos uno básico
                const userInDb = users.find(user => user.email === email);
                return {
                    name: userInDb ? userInDb.name : 'Estudiante CFT',
                    email: email,
                    phone: '+56 9 1234 5678', // Default phone
                    rut: userInDb ? userInDb.password : '12.345.678-K', // Use password as RUT for default
                    profilePic: DEFAULT_AVATAR_PATH
                };
            }
        }

        /**
         * Guarda los datos de un perfil en el localStorage y actualiza la UI si es el usuario actual.
         * @param {string} email - El email del usuario.
         * @param {object} profile - El objeto con los datos del perfil a guardar.
         */
        function saveProfileData(email, profile) {
            const profileKey = `profile_${email}`;
            localStorage.setItem(profileKey, JSON.stringify(profile));
            const loggedInUser = localStorage.getItem('currentUserEmail');
            if (loggedInUser === email) {
                navProfilePic.src = profile.profilePic || DEFAULT_AVATAR_PATH;
                dropdownProfilePic.src = profile.profilePic || DEFAULT_AVATAR_PATH;
                dropdownUsername.textContent = profile.name || loggedInUser;
            }
        }

        /**
         * Carga los datos del perfil del usuario actual en el formulario de detalles de perfil.
         * @param {string} email - El email del usuario actual.
         */
        function loadProfileData(email) {
            const profile = getProfileData(email);
            profileNameInput.value = profile.name;
            profileEmailInput.value = profile.email;
            profilePhoneInput.value = profile.phone;
            profileRutInput.value = profile.rut;
            profilePic.src = profile.profilePic || DEFAULT_AVATAR_PATH;
            
            // Determina si se muestra el botón de eliminar foto
            const isDefaultPic = profile.profilePic === DEFAULT_AVATAR_PATH || (window.location.origin + '/' + DEFAULT_AVATAR_PATH) === profile.profilePic;
            deleteProfilePicBtn.style.display = isDefaultPic ? 'none' : 'inline-block';
            profileMessage.textContent = '';
        }

        /**
         * Establece el estado del formulario de perfil (edición o visualización).
         * Habilita/deshabilita campos y muestra/oculta botones.
         * @param {boolean} isEditing - `true` para modo edición, `false` para modo visualización.
         */
        function setProfileFormState(isEditing) {
            profileNameInput.disabled = !isEditing;
            profilePhoneInput.disabled = !isEditing;
            profileRutInput.disabled = !isEditing;

            profilePic.style.cursor = isEditing ? 'pointer' : 'default';

            editProfileBtn.style.display = isEditing ? 'none' : 'inline-block';
            saveProfileBtn.style.display = isEditing ? 'inline-block' : 'none';
            cancelEditBtn.style.display = isEditing ? 'inline-block' : 'none';
            
            // El botón de eliminar foto solo se muestra si está editando Y no es la foto por defecto
            const isDefaultPic = profilePic.src.includes(DEFAULT_AVATAR_PATH);
            deleteProfilePicBtn.style.display = (isEditing && !isDefaultPic) ? 'inline-block' : 'none';
        }

        /**
         * Maneja la subida de una nueva foto de perfil.
         * Convierte la imagen a Data URL y la guarda en localStorage.
         * @param {Event} e - El evento de cambio del input file.
         */
        function handleProfileImageUpload(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(event) {
                    profilePic.src = event.target.result;
                    const loggedInUser = localStorage.getItem('currentUserEmail');
                    if (loggedInUser) {
                        const currentProfile = getProfileData(loggedInUser);
                        currentProfile.profilePic = event.target.result;
                        saveProfileData(loggedInUser, currentProfile);
                        profileMessage.textContent = 'Foto de perfil cargada. Haz clic en "Guardar Cambios".';
                        profileMessage.style.color = getCssVariable('--color-advertencia');
                        deleteProfilePicBtn.style.display = 'inline-block';
                    }
                };
                reader.readAsDataURL(file);
            }
        }

        /**
         * Elimina la foto de perfil del usuario, volviendo al avatar por defecto.
         */
        function handleDeleteProfilePic() {
            const loggedInUser = localStorage.getItem('currentUserEmail');
            if (loggedInUser) {
                const currentProfile = getProfileData(loggedInUser);
                currentProfile.profilePic = DEFAULT_AVATAR_PATH;
                profilePic.src = DEFAULT_AVATAR_PATH;
                saveProfileData(loggedInUser, currentProfile);
                profileMessage.textContent = 'Foto de perfil eliminada. Haz clic en "Guardar Cambios".';
                profileMessage.style.color = getCssVariable('--color-advertencia');
                deleteProfilePicBtn.style.display = 'none';
            }
        }

        /*
           ====================================================================
           SECCIÓN: LÓGICA DEL DIRECTORIO (ACTUALIZADA para mostrar por sede)
           ====================================================================
        */

        /**
         * Renderiza la lista de contactos del directorio, agrupados por sede.
         */
        function renderDirectory() {
            directoryList.innerHTML = ''; // Limpia la lista existente
            
            for (const sede in directoryDataBySede) {
                if (directoryDataBySede.hasOwnProperty(sede)) {
                    // Crea un encabezado para la sede
                    const sedeHeading = document.createElement('h2');
                    sedeHeading.classList.add('sede-title'); // Clase para el estilo del título de sede
                    sedeHeading.textContent = sede;
                    directoryList.appendChild(sedeHeading);

                    // Crea un contenedor para los contactos de esta sede (que será un grid)
                    const sedeContactsGrid = document.createElement('div');
                    sedeContactsGrid.classList.add('directory-grid'); // Aplica las clases de grid aquí

                    directoryDataBySede[sede].forEach((contact, index) => {
                        const card = document.createElement('div');
                        card.classList.add('directory-card');
                        // Usamos un identificador único para el contacto que incluya la sede y el índice
                        card.dataset.contactId = `${sede.replace(/\s/g, '')}-${index}`; 
                        card.innerHTML = `
                            <span class="icon">${contact.icon}</span>
                            <div>
                                <h3>${contact.name}</h3>
                                <p>${contact.position}</p>
                            </div>
                        `;
                        sedeContactsGrid.appendChild(card);
                    });
                    directoryList.appendChild(sedeContactsGrid);
                }
            }

            // Añadir event listeners a las nuevas tarjetas del directorio
            // Delegamos el evento al contenedor principal para evitar añadir muchos listeners
            directoryList.addEventListener('click', (e) => {
                const card = e.target.closest('.directory-card');
                if (card) {
                    const contactId = card.dataset.contactId;
                    // Encontrar el contacto usando el contactId
                    let foundContact = null;
                    for (const sede in directoryDataBySede) {
                        const contactIndex = parseInt(contactId.split('-').pop());
                        // La parte del contactId antes del último '-' debe coincidir con la sede normalizada
                        if (contactId.startsWith(sede.replace(/\s/g, '')) && directoryDataBySede[sede][contactIndex]) {
                             foundContact = directoryDataBySede[sede][contactIndex];
                             break;
                        }
                    }

                    if (foundContact) {
                        showContactDetailsModal(foundContact);
                    }
                }
            });
        }

        /**
         * Muestra un modal con los detalles del contacto en formato normal (no C++-like).
         * @param {object} contact - El objeto de contacto a mostrar.
         */
        function showContactDetailsModal(contact) {
            contactDetailsTitle.textContent = `Detalles de ${contact.name}`;
            contactDetailsOutput.innerHTML = `
                <p><strong>Cargo:</strong> ${contact.position}</p>
                <p><strong>Departamento:</strong> ${contact.department}</p>
                <p><strong>Email:</strong> <a href="mailto:${contact.email}">${contact.email}</a></p>
                <p><strong>Teléfono:</strong> <a href="tel:${contact.phone}">${contact.phone}</a></p>
            `;
            contactDetailsModal.classList.add('show');
        }

        /**
         * Cierra el modal de detalles del contacto.
         */
        function closeContactDetailsModal() {
            contactDetailsModal.classList.remove('show');
        }

        /**
         * Inicializa la sección de Notas y Asistencia:
         * - Cambia el color de las notas según su valor.
         * - Anima las tarjetas de las materias.
         */
        function initializeNotesSection() {
            // Cambiar el color de las notas según su valor
            document.querySelectorAll('#notes-attendance-section .nota-value').forEach(nota => {
                const value = parseFloat(nota.textContent);
                if (value < 4.0) {
                    nota.style.backgroundColor = getCssVariable('--color-error'); // Rojo para notas bajas
                } else if (value < 5.0) {
                    nota.style.backgroundColor = getCssVariable('--accent-login-color'); // Naranjo para notas regulares
                } else {
                    nota.style.backgroundColor = getCssVariable('--color-exito'); // Verde para notas buenas
                }
            });
            
            // Animación al cargar las tarjetas
            const cards = document.querySelectorAll('#notes-attendance-section .materia-card');
            cards.forEach((card, index) => {
                card.style.opacity = '0'; // Reset opacity for re-animation
                card.style.transform = 'translateY(20px)'; // Reset transform for re-animation
                setTimeout(() => {
                    card.style.opacity = '1';
                    card.style.transform = 'translateY(0)';
                }, 100 * index); // Staggered animation
            });
        }

        /**
         * Toggles the visibility of a scholarship item's content.
         * This function is called directly from inline onclick attributes in the HTML.
         * @param {HTMLElement} element - The header element of the scholarship item.
         */
        function toggleBeca(element) {
            const content = element.nextElementSibling;
            const icon = element.querySelector('.toggle-icon');
            if (content.style.display === "block") {
                content.style.display = "none";
                icon.textContent = "+";
            } else {
                content.style.display = "block";
                icon.textContent = "-";
            }
        }


        /*
           ====================================================================
           SECCIÓN: CONFIGURACIÓN DE EVENT LISTENERS
           Descripción: Agrupa todos los escuchadores de eventos para mejorar
                        la organización y la legibilidad.
           ====================================================================
        */

        /**
         * Configura todos los escuchadores de eventos de la aplicación.
         */
        function setupEventListeners() {
            // Navegación y menú móvil
            menuToggle.addEventListener('click', () => {
                navUl.classList.toggle('active');
                profileDropdown.classList.remove('show'); // Asegura que el dropdown de perfil se cierre al abrir/cerrar el menú móvil
            });

            // Clic en el enlace del perfil en la navegación (para mostrar/ocultar dropdown en desktop)
            profileNavLink.addEventListener('click', (e) => {
                e.stopPropagation();
                e.preventDefault();
                if (navUl.classList.contains('active')) {
                    // Si el menú móvil está activo, navega a la sección de perfil
                    navUl.classList.remove('active');
                    showSection('user-profile-detail');
                } else {
                    // Si no, alterna el dropdown de perfil (en desktop)
                    profileDropdown.classList.toggle('show');
                }
            });

            // Delegación de eventos para la barra de navegación (logo y enlaces generales)
            document.querySelector('header .container').addEventListener('click', (e) => {
                let target = e.target;
                if ((target.tagName === 'IMG' && target.closest('.logo')) || target.classList.contains('logo')) {
                    target = target.closest('.logo');
                }
                if (target.tagName === 'A' && target.dataset.section) {
                    e.preventDefault();
                    navUl.classList.remove('active');
                    showSection(target.dataset.section);
                }
            });

            // Clics dentro del dropdown de perfil (Ver Perfil, Cerrar Sesión)
            profileDropdown.addEventListener('click', (e) => {
                e.stopPropagation(); // Evita que el clic se propague al documento
                const target = e.target;
                if (target.tagName === 'A') {
                    e.preventDefault();
                    profileDropdown.classList.remove('show'); // Cierra el dropdown
                    navUl.classList.remove('active'); // Asegura que el menú móvil también se cierre
                    if (target.dataset.section === 'user-profile-detail') {
                        showSection('user-profile-detail');
                    } else if (target.dataset.action === 'logout') {
                        localStorage.removeItem('currentUserEmail');
                        updateAuthUI(); // Actualiza la UI después del logout
                    }
                }
            });

            // Clics en las tarjetas de módulo
            document.querySelectorAll('.module-card').forEach(card => {
                card.addEventListener('click', () => {
                    const targetSection = card.dataset.section;
                    if (targetSection) {
                        showSection(targetSection);
                    }
                });
            });

            // Botón "Iniciar Sesión" en la sección de bienvenida
            document.querySelector('#home-section .btn-primario').addEventListener('click', openLoginModal);
            
            // Cerrar modal
            closeModalButton.addEventListener('click', closeLoginModal);
            window.addEventListener('click', (e) => {
                if (e.target === loginModal) {
                    closeLoginModal();
                }
            });

            // Toggle entre registro y login dentro del modal
            modalToggleFormLink.addEventListener('click', (e) => {
                e.preventDefault();
                // Remove shake class before changing mode
                loginContainerMain.classList.remove('shake');
                isRegistering ? setFormToLoginMode() : setFormToRegisterMode();
            });

            // Envío del formulario de autenticación (loginBtn submit)
            authForm.addEventListener('submit', (e) => {
                e.preventDefault();
                setLoading(true); // Show loading spinner
                loginContainerMain.classList.remove('shake'); // Remove shake animation if present

                const email = emailInput.value.trim();
                const password = passwordInput.value.trim();

                if (email.length < 5 || password.length < 4) {
                    showNotification('error', 'El email debe tener al menos 5 caracteres y la contraseña al menos 4.');
                    loginContainerMain.classList.add('shake'); // Add shake animation
                    setLoading(false);
                    return;
                }

                if (isRegistering) {
                    // Check if email exists in the hardcoded 'users' array
                    const userExists = users.some(user => user.email === email);
                    if (userExists || localStorage.getItem(email)) { // Also check local storage for consistency
                        showNotification('error', 'Este email ya está registrado o en uso.');
                        loginContainerMain.classList.add('shake');
                        setLoading(false);
                    } else {
                        // For demonstration, register directly to localStorage and add to our 'users' array
                        localStorage.setItem(email, password);
                        // Add to in-memory 'users' array for immediate use
                        users.push({ name: 'Nuevo Estudiante', email: email, password: email }); // Use email as password for new user
                        
                        // Initialize basic profile data for new user in localStorage
                        saveProfileData(email, { name: 'Nuevo Estudiante', email: email, phone: '', rut: '', profilePic: DEFAULT_AVATAR_PATH });
                        
                        localStorage.setItem('currentUserEmail', email);
                        showNotification('success', '¡Registro exitoso! Has iniciado sesión.');
                        loginContainerMain.classList.add('success-pulse'); // Add success animation
                        setTimeout(() => { 
                            closeLoginModal(); 
                            updateAuthUI(); 
                            loginContainerMain.classList.remove('success-pulse'); // Remove pulse after transition
                            setLoading(false);
                        }, 1000); // Allow time for success message and animation
                    }
                } else { // Login
                    const foundUser = users.find(user => user.email === email && user.password === password);
                    const storedPassword = localStorage.getItem(email); // Also check localStorage for dynamically registered users

                    if (foundUser || (storedPassword && storedPassword === password)) {
                        localStorage.setItem('currentUserEmail', email);
                        showNotification('success', '¡Inicio de sesión exitoso! Entrando a la Intranet de CFT Los Ríos.');
                        loginContainerMain.classList.add('success-pulse'); // Add success animation
                        setTimeout(() => { 
                            closeLoginModal(); 
                            updateAuthUI(); 
                            loginContainerMain.classList.remove('success-pulse'); // Remove pulse after transition
                            setLoading(false);
                        }, 1000); // Allow time for success message and animation
                    } else {
                        showNotification('error', 'Credenciales no válidas, Intente nuevamente.');
                        loginContainerMain.classList.add('shake'); // Add shake animation
                        setLoading(false);
                    }
                }
            });

            // Perfil detallado - Edición, Guardar, Cancelar
            editProfileBtn.addEventListener('click', () => {
                setProfileFormState(true);
                profileMessage.textContent = '';
            });

            cancelEditBtn.addEventListener('click', () => {
                const loggedInUser = localStorage.getItem('currentUserEmail');
                if (loggedInUser) loadProfileData(loggedInUser);
                setProfileFormState(false);
                profileMessage.textContent = 'Edición cancelada.';
                profileMessage.style.color = getCssVariable('--color-advertencia');
            });

            profileForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const loggedInUser = localStorage.getItem('currentUserEmail');
                if (!loggedInUser) {
                    profileMessage.textContent = 'Error: Debes iniciar sesión para guardar tu perfil.';
                    profileMessage.style.color = getCssVariable('--color-error');
                    return;
                }

                if (!profileNameInput.value.trim() || !profileEmailInput.value.trim() || !profileEmailInput.value.includes('@')) {
                    profileMessage.textContent = 'Por favor, completa los campos requeridos con datos válidos.';
                    profileMessage.style.color = getCssVariable('--color-error');
                    return;
                }

                const currentProfile = getProfileData(loggedInUser);
                const updatedProfile = {
                    name: profileNameInput.value.trim(),
                    email: profileEmailInput.value.trim(), // Email no se puede editar, pero se mantiene en el objeto
                    phone: profilePhoneInput.value.trim(),
                    rut: profileRutInput.value.trim(),
                    profilePic: currentProfile.profilePic
                };
                saveProfileData(loggedInUser, updatedProfile);
                profileMessage.textContent = '¡Perfil actualizado exitosamente!';
                profileMessage.style.color = getCssVariable('--color-exito');
                setProfileFormState(false);
            });

            // Gestión de foto de perfil
            profilePic.addEventListener('click', () => {
                if (!profileNameInput.disabled) profileImageUpload.click(); // Permite clickear solo en modo edición
            });
            profileImageUpload.addEventListener('change', handleProfileImageUpload);
            deleteProfilePicBtn.addEventListener('click', handleDeleteProfilePic);

            // Botones de retroceso
            backButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const loggedInUser = localStorage.getItem('currentUserEmail');
                    showSection(loggedInUser ? 'modules' : 'home');
                });
            });

            // Cierra el dropdown de perfil si se hace clic fuera de él (en desktop)
            document.addEventListener('click', (e) => {
                if (!profileNavLink.contains(e.target) && profileDropdown.classList.contains('show') && !navUl.classList.contains('active')) {
                    profileDropdown.classList.remove('show');
                }
            });

            // Lógica del Formulario de Notificaciones
            notificationForm.addEventListener('submit', async (event) => {
                event.preventDefault(); // Evita el envío del formulario por defecto (recarga de página)

                const email = emailNotificationInput.value;
                const phone = phoneNotificationInput.value;
                const message = messageNotificationInput.value;

                // Validación básica de campos
                if (!email || !phone || !message) {
                    showFormMessage('Por favor, completa todos los campos.', 'error');
                    return;
                }

                // Validación simple de formato de correo electrónico
                const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                if (!emailRegex.test(email)) {
                    showFormMessage('Por favor, introduce un correo electrónico válido.', 'error');
                    return;
                }

                // Simulación de envío (esta parte no es real)
                showFormMessage('Enviando notificación...', 'info');

                // En un entorno real, aquí harías una petición a tu servidor backend:
                /*
                try {
                    const response = await fetch('/api/send-notification', { // Esta URL sería la de tu backend
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({ email, phone, message })
                    });

                    if (response.ok) {
                        const result = await response.json();
                        showFormMessage(`Notificación enviada con éxito a ${email} y ${phone}.`, 'success');
                        notificationForm.reset(); // Limpia el formulario
                    } else {
                        const errorData = await response.json();
                        showFormMessage(`Error al enviar la notificación: ${errorData.message || 'Error desconocido'}`, 'error');
                    }
                } catch (error) {
                    console.error('Error de red o del servidor:', error);
                    showFormMessage('Hubo un problema de conexión. Inténtalo de nuevo.', 'error');
                }
                */

                // Para esta simulación, simplemente esperamos un poco y mostramos éxito
                await new Promise(resolve => setTimeout(resolve, 2000)); // Simula un retraso de 2 segundos

                showFormMessage(`Notificación ficticia enviada a: Correo (${email}), Teléfono (${phone}). Mensaje: "${message}"`, 'success');
                notificationForm.reset(); // Limpia el formulario después de la simulación
            });

            // Lógica del Modal de Detalles del Contacto (NUEVO)
            closeContactDetailsModalBtn.addEventListener('click', closeContactDetailsModal);
            window.addEventListener('click', (e) => {
                if (e.target === contactDetailsModal) {
                    closeContactDetailsModal();
                }
            });

            // Lógica del Formulario de Reportar Problemas (NUEVO - integrado de problema.html)
            reportIssueForm.addEventListener('submit', async (e) => {
                e.preventDefault(); // Evita el envío tradicional del formulario

                // Deshabilita el botón y cambia el texto mientras se envía
                submitReportBtn.disabled = true;
                submitReportBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Enviando...';

                // Recopila los datos del formulario
                const nombre = document.getElementById('nombreEstudiante').value;
                const carrera = document.getElementById('carreraEstudiante').value; // Obtener valor del select
                const profesor = document.getElementById('profesorCarrera').value;
                const motivo = document.getElementById('motivoReporte').value;

                // Simple validación
                // Asegúrate de que la carrera seleccionada no sea la opción por defecto vacía
                if (!nombre || !carrera || carrera === "" || !motivo) {
                    showReportFormMessage('Por favor, completa todos los campos requeridos (Nombre, Carrera, Motivo).', 'error');
                    submitReportBtn.disabled = false; // Re-habilita el botón
                    submitReportBtn.innerHTML = '<i class="fas fa-paper-plane"></i> Enviar Reporte';
                    return;
                }

                showReportFormMessage('Enviando reporte...', 'info');
                
                await new Promise(resolve => setTimeout(resolve, 2500)); // Simula un retraso de 2.5 segundos

                // Aquí es donde normalmente enviarías los datos a un servidor.
                // Ejemplo con fetch API (descomenta y adapta a tu backend real):
                /*
                try {
                    const response = await fetch('/api/reportar-problema', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({ nombre, carrera, profesor, motivo }),
                    });

                    if (response.ok) {
                        showReportFormMessage('Reporte enviado con éxito. ¡Gracias por tu retroalimentación!', 'success');
                        reportIssueForm.reset(); // Limpia el formulario al éxito
                    } else {
                        const errorData = await response.json();
                        showReportFormMessage(`Error al enviar el reporte: ${errorData.message || 'Inténtalo de nuevo.'}`, 'error');
                    }
                } catch (error) {
                    console.error('Error de red o del servidor:', error);
                    showReportFormMessage('Hubo un problema de conexión. Por favor, inténtalo más tarde.', 'error');
                } finally {
                    submitReportBtn.disabled = false; // Siempre re-habilita el botón
                    submitReportBtn.innerHTML = '<i class="fas fa-paper-plane"></i> Enviar Reporte';
                }
                */

                // Para esta simulación, asumimos éxito
                showReportFormMessage('Reporte enviado con éxito. ¡Gracias por tu retroalimentación!', 'success');
                reportIssueForm.reset(); // Limpia el formulario después de la simulación
                submitReportBtn.disabled = false; // Re-habilita el botón
                submitReportBtn.innerHTML = '<i class="fas fa-paper-plane"></i> Enviar Reporte';
            });

        }

        /*
           ====================================================================
           SECCIÓN: INICIALIZACIÓN
           Descripción: Función que se ejecuta cuando el DOM está completamente
                        cargado para configurar la aplicación.
           ====================================================================
        */
        document.addEventListener('DOMContentLoaded', () => {
            setupEventListeners(); 
            setInitialTheme(); // Aplicar tema guardado o default al cargar
            updateAuthUI(); 
            initializeAdmisionForm(); 
            initializeNoticiasFilters(); 
            
            // Event listener para el botón de cambio de tema
            if(themeToggleButton) {
                themeToggleButton.addEventListener('click', toggleTheme);
            }
            if(navSearchButton) {
                navSearchButton.addEventListener('click', handleSiteSearch);
            }
            if(navSearchInput) {
                navSearchInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        handleSiteSearch();
                    }
                });
                 // Opcional: limpiar búsqueda si el input se vacía manualmente
                navSearchInput.addEventListener('input', function() {
                    if (this.value.trim() === '') {
                        // Podríamos llamar a una función que restaure todo
                        // o simplemente no hacer nada hasta que se presione buscar/enter de nuevo.
                        // Por ahora, se restaurará al borrar y presionar Enter o el botón.
                    }
                });
            }
        });

        function initializeAdmisionForm() {
            const carrerasPorSedeAdmision = {
                valdivia: [{ value: 'refrigeracion', text: 'TNS en Refrigeración y Climatización' }],
                launion: [{ value: 'agroindustria', text: 'TNS en Agroindustria e Innovación Alimentaria' }, { value: 'admin', text: 'TNS en Administración Pública y Privada' }, { value: 'comunicacion', text: 'TNS en Comunicación y Audiovisual' }],
                paillaco: [{ value: 'informatica', text: 'TNS en Informática y Data Science' }, { value: 'podologia', text: 'TNS en Podología' }, { value: 'enfermeria', text: 'TNS en Enfermería' }],
                panguipulli: [{ value: 'admin', text: 'TNS en Administración Pública y Privada' }, { value: 'construccion', text: 'TNS en Construcción mención Eficiencia Energética' }]
            };

            const sedeSelectAdmision = document.getElementById('admision-sede');
            const carreraSelectAdmision = document.getElementById('admision-carrera');
            const telefonoInputAdmision = document.getElementById('admision-telefono');
            const admisionForm = document.getElementById('admisionForm');

            if (sedeSelectAdmision && carreraSelectAdmision) {
                sedeSelectAdmision.addEventListener('change', (event) => {
                    const sedeSeleccionada = event.target.value;
                    const carreras = carrerasPorSedeAdmision[sedeSeleccionada] || [];
                    carreraSelectAdmision.innerHTML = '<option value="" disabled selected>-- Elige una carrera --</option>'; 
                    carreraSelectAdmision.disabled = false;
                    carreras.forEach(carrera => {
                        let option = document.createElement('option');
                        option.value = carrera.value;
                        // Se elimina el span con estilo para simplificar, el estilo del select debe ser general
                        option.textContent = carrera.text; 
                        carreraSelectAdmision.appendChild(option);
                    });
                });
            }

            if (telefonoInputAdmision) {
                const prefijo = "+56 ";
                telefonoInputAdmision.addEventListener('input', () => {
                    let valor = telefonoInputAdmision.value;
                    if (!valor.startsWith(prefijo)) {
                        valor = prefijo;
                    }
                    let numeros = valor.substring(prefijo.length).replace(/\D/g, '');
                    if (numeros.length > 9) {
                        numeros = numeros.substring(0, 9);
                    }
                    telefonoInputAdmision.value = prefijo + numeros;
                });

                telefonoInputAdmision.addEventListener('focus', () => {
                    if (telefonoInputAdmision.value === "") {
                        telefonoInputAdmision.value = prefijo;
                    }
                });
            }

            if (admisionForm) {
                admisionForm.addEventListener('submit', (event) => {
                    event.preventDefault(); 
                    // Aquí puedes usar la función showNotification o una alerta simple
                    showNotification('success', '¡Datos enviados! Nos contactaremos pronto.');
                    // alert('¡Datos enviados correctamente!\nNos pondremos en contacto contigo pronto.');
                    admisionForm.reset();
                    if(carreraSelectAdmision) {
                        carreraSelectAdmision.innerHTML = '<option value="" disabled selected>-- Primero elige una sede --</option>';
                        carreraSelectAdmision.disabled = true;
                    }
                    if(telefonoInputAdmision) {
                        telefonoInputAdmision.value = '';
                    }
                });
            }
        }

        function initializeNoticiasFilters() {
            const filterBtns = document.querySelectorAll('#noticias-section .filter-btn');
            const newsCards = document.querySelectorAll('#noticias-section .news-card');
            const newsContainer = document.querySelector('#noticias-section .news-container');

            if (!filterBtns.length || !newsCards.length || !newsContainer) {
                // console.warn("Elementos para filtros de noticias no encontrados. Saltando inicialización de filtros.");
                return;
            }
            
            function filterNews(filter) {
                newsCards.forEach(card => {
                    // Forzar la re-evaluación del layout antes de cambiar display para animación
                    void card.offsetWidth; 

                    if (filter === 'all' || card.classList.contains(filter)) {
                        card.style.display = 'block'; // O 'flex' o 'grid-item' dependiendo del layout de .news-row
                        card.style.animation = 'fadeIn 0.5s ease-out forwards';
                    } else {
                        card.style.animation = 'fadeOut 0.3s ease-out forwards';
                        setTimeout(() => {
                            card.style.display = 'none';
                        }, 300); // Coincidir con la duración de fadeOut
                    }
                });
            }
            
            filterBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    filterBtns.forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    const filterValue = this.getAttribute('data-filter');
                    filterNews(filterValue);
                    
                    // Opcional: Scroll suave al contenedor de noticias si está fuera de vista
                    // newsContainer.scrollIntoView({ behavior: 'smooth', block: 'start' });
                });
            });
            
            // Activar el filtro "Todos" por defecto al cargar la sección
            const allFilterBtn = document.querySelector('#noticias-section .filter-btn[data-filter="all"]');
            if (allFilterBtn) {
                allFilterBtn.classList.add('active');
                filterNews('all'); // Aplicar filtro inicial
            }

            // Añadir animaciones fadeIn/fadeOut si no existen
            const styleSheet = document.styleSheets[0];
            let fadeInExists = false;
            let fadeOutExists = false;
            for (let i = 0; i < styleSheet.cssRules.length; i++) {
                if (styleSheet.cssRules[i].name === 'fadeIn') fadeInExists = true;
                if (styleSheet.cssRules[i].name === 'fadeOut') fadeOutExists = true;
            }

            if (!fadeInExists) {
                try {
                    styleSheet.insertRule(`
                        @keyframes fadeIn {
                            from { opacity: 0; transform: translateY(15px); }
                            to { opacity: 1; transform: translateY(0); }
                        }`, styleSheet.cssRules.length);
                } catch (e) {
                    console.error("Error insertando regla fadeIn: ", e);
                }
            }
            if (!fadeOutExists) {
                 try {
                    styleSheet.insertRule(`
                        @keyframes fadeOut {
                            from { opacity: 1; transform: translateY(0); }
                            to { opacity: 0; transform: translateY(15px); }
                        }`, styleSheet.cssRules.length);
                } catch (e) {
                    console.error("Error insertando regla fadeOut: ", e);
                }
            }
        }

        // --- Funcionalidad de Cambio de Tema ---
        function setInitialTheme() {
            const savedTheme = localStorage.getItem('theme') || 'light';
            if (savedTheme === 'dark') {
                document.body.classList.add('theme-dark');
                themeToggleButton.innerHTML = '<i class="fas fa-sun"></i>'; // Icono de sol para tema oscuro
            } else {
                document.body.classList.remove('theme-dark');
                themeToggleButton.innerHTML = '<i class="fas fa-moon"></i>'; // Icono de luna para tema claro
            }
        }

        function toggleTheme() {
            if (document.body.classList.contains('theme-dark')) {
                document.body.classList.remove('theme-dark');
                localStorage.setItem('theme', 'light');
                themeToggleButton.innerHTML = '<i class="fas fa-moon"></i>';
            } else {
                document.body.classList.add('theme-dark');
                localStorage.setItem('theme', 'dark');
                themeToggleButton.innerHTML = '<i class="fas fa-sun"></i>';
            }
        }
        // --- Fin Funcionalidad de Cambio de Tema ---


        function initializeNoticiasFilters() {
            const filterBtns = document.querySelectorAll('#noticias-section .filter-btn');
            const newsCards = document.querySelectorAll('#noticias-section .news-card');
            const newsContainer = document.querySelector('#noticias-section .news-container');

            if (!filterBtns.length || !newsCards.length || !newsContainer) {
                // console.warn("Elementos para filtros de noticias no encontrados. Saltando inicialización de filtros.");
                return;
            }
            
            function filterNews(filter) {
                newsCards.forEach(card => {
                    // Forzar la re-evaluación del layout antes de cambiar display para animación
                    void card.offsetWidth; 

                    if (filter === 'all' || card.classList.contains(filter)) {
                        card.style.display = 'block'; // O 'flex' o 'grid-item' dependiendo del layout de .news-row
                        card.style.animation = 'fadeIn 0.5s ease-out forwards';
                    } else {
                        card.style.animation = 'fadeOut 0.3s ease-out forwards';
                        setTimeout(() => {
                            card.style.display = 'none';
                        }, 300); // Coincidir con la duración de fadeOut
                    }
                });
            }
            
            filterBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    filterBtns.forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    const filterValue = this.getAttribute('data-filter');
                    filterNews(filterValue);
                    
                    // Opcional: Scroll suave al contenedor de noticias si está fuera de vista
                    // newsContainer.scrollIntoView({ behavior: 'smooth', block: 'start' });
                });
            });
            
            // Activar el filtro "Todos" por defecto al cargar la sección
            const allFilterBtn = document.querySelector('#noticias-section .filter-btn[data-filter="all"]');
            if (allFilterBtn) {
                allFilterBtn.classList.add('active');
                // filterNews('all'); // Aplicar filtro inicial - Se comenta para que no se ejecute antes de que la sección sea visible
            }

            // Añadir animaciones fadeIn/fadeOut si no existen
            const styleSheet = document.styleSheets[0];
            let fadeInExists = false;
            let fadeOutExists = false;
            if (styleSheet) { // Asegurarse que styleSheet existe
                for (let i = 0; i < styleSheet.cssRules.length; i++) {
                    if (styleSheet.cssRules[i].name === 'fadeIn') fadeInExists = true;
                    if (styleSheet.cssRules[i].name === 'fadeOut') fadeOutExists = true;
                }

                if (!fadeInExists) {
                    try {
                        styleSheet.insertRule(`
                            @keyframes fadeIn {
                                from { opacity: 0; transform: translateY(15px); }
                                to { opacity: 1; transform: translateY(0); }
                            }`, styleSheet.cssRules.length);
                    } catch (e) {
                        console.error("Error insertando regla fadeIn: ", e);
                    }
                }
                if (!fadeOutExists) {
                     try {
                        styleSheet.insertRule(`
                            @keyframes fadeOut {
                                from { opacity: 1; transform: translateY(0); }
                                to { opacity: 0; transform: translateY(15px); }
                            }`, styleSheet.cssRules.length);
                    } catch (e) {
                        console.error("Error insertando regla fadeOut: ", e);
                    }
                }
            }
        }

        // --- Funcionalidad de Búsqueda ---
        function handleSiteSearch() {
            const searchTerm = navSearchInput.value.trim().toLowerCase();
            if (!searchTerm) {
                // Si no hay término de búsqueda, restaurar la visibilidad de todos los elementos relevantes
                // Esto es una simplificación; una implementación más robusta podría recordar el estado anterior.
                document.querySelectorAll('.news-card, .module-card, #carreras-info-section li, #vida-estudiantil-section .card, #vida-estudiantil-section .faq-item').forEach(el => {
                    el.style.display = ''; // Restablecer display
                    el.classList.remove('search-highlight'); // Remover resaltado
                });
                // También asegurarse de que las secciones activas se muestren correctamente si la búsqueda las ocultó.
                // Por ahora, no ocultaremos secciones enteras, solo elementos dentro de ellas.
                return;
            }

            let foundItems = 0;

            // 1. Búsqueda en Tarjetas de Noticias (título y texto)
            document.querySelectorAll('#noticias-section .news-card').forEach(card => {
                const title = card.querySelector('.card-title')?.textContent.toLowerCase() || '';
                const text = card.querySelector('.card-text')?.textContent.toLowerCase() || '';
                if (title.includes(searchTerm) || text.includes(searchTerm)) {
                    card.style.display = 'block'; // O el display original
                    card.classList.add('search-highlight');
                    foundItems++;
                } else {
                    card.style.display = 'none';
                    card.classList.remove('search-highlight');
                }
            });
            
            // 2. Búsqueda en Módulos (título y descripción)
            document.querySelectorAll('#modules-section .module-card').forEach(card => {
                const title = card.querySelector('h3')?.textContent.toLowerCase() || '';
                const text = card.querySelector('p')?.textContent.toLowerCase() || '';
                 if (title.includes(searchTerm) || text.includes(searchTerm)) {
                    card.style.display = 'block'; // O 'grid' si es item de grid
                    card.classList.add('search-highlight');
                    foundItems++;
                } else {
                    card.style.display = 'none';
                    card.classList.remove('search-highlight');
                }
            });

            // 3. Búsqueda en lista de Carreras
            document.querySelectorAll('#carreras-info-section li').forEach(item => {
                const text = item.textContent.toLowerCase();
                if (text.includes(searchTerm)) {
                    item.style.display = 'list-item';
                    item.classList.add('search-highlight');
                    foundItems++;
                } else {
                    item.style.display = 'none';
                    item.classList.remove('search-highlight');
                }
            });
            
            // 4. Búsqueda en Vida Estudiantil (títulos de cards y FAQ)
            document.querySelectorAll('#vida-estudiantil-section .card, #vida-estudiantil-section .faq-item').forEach(item => {
                const title = item.querySelector('h3')?.textContent.toLowerCase() || '';
                const textContent = item.querySelector('p')?.textContent.toLowerCase() || '';
                if (title.includes(searchTerm) || textContent.includes(searchTerm)) {
                    item.style.display = 'block'; // O 'grid-item' para cards
                    item.classList.add('search-highlight');
                    foundItems++;
                } else {
                    item.style.display = 'none';
                    item.classList.remove('search-highlight');
                }
            });

            // Podríamos mostrar un mensaje si no se encuentran resultados
            if (foundItems === 0 && searchTerm) {
                // Idealmente, mostrar esto en un lugar visible, no solo consola.
                console.log(`No se encontraron resultados para "${navSearchInput.value.trim()}".`);
                 // showNotification('info', `No se encontraron resultados para "${navSearchInput.value.trim()}".`);
            }
            
            // Importante: esta búsqueda es muy básica. No maneja bien el cambio de secciones.
            // Si el usuario está en "Módulos" y busca algo que está en "Noticias",
            // los elementos de noticias se mostrarán/ocultarán, pero el usuario no será llevado a esa sección.
            // Una implementación más completa requeriría cambiar a la sección donde se encontró el resultado.
        }
        // --- Fin Funcionalidad de Búsqueda ---


        // --- Funcionalidad de Cambio de Tema ---
        function setInitialTheme() {
            const savedTheme = localStorage.getItem('theme') || 'light';
            if (savedTheme === 'dark') {
                document.body.classList.add('theme-dark');
                themeToggleButton.innerHTML = '<i class="fas fa-sun"></i>'; // Icono de sol para tema oscuro
            } else {
                document.body.classList.remove('theme-dark');
                themeToggleButton.innerHTML = '<i class="fas fa-moon"></i>'; // Icono de luna para tema claro
            }
        }

        function toggleTheme() {
            if (document.body.classList.contains('theme-dark')) {
                document.body.classList.remove('theme-dark');
                localStorage.setItem('theme', 'light');
                themeToggleButton.innerHTML = '<i class="fas fa-moon"></i>';
            } else {
                document.body.classList.add('theme-dark');
                localStorage.setItem('theme', 'dark');
                themeToggleButton.innerHTML = '<i class="fas fa-sun"></i>';
            }
        }
        // --- Fin Funcionalidad de Cambio de Tema ---


        function initializeNoticiasFilters() {
            const filterBtns = document.querySelectorAll('#noticias-section .filter-btn');
            const newsCards = document.querySelectorAll('#noticias-section .news-card');
            const newsContainer = document.querySelector('#noticias-section .news-container');

            if (!filterBtns.length || !newsCards.length || !newsContainer) {
                // console.warn("Elementos para filtros de noticias no encontrados. Saltando inicialización de filtros.");
                return;
            }
            
            function filterNews(filter) {
                newsCards.forEach(card => {
                    // Forzar la re-evaluación del layout antes de cambiar display para animación
                    void card.offsetWidth; 

                    if (filter === 'all' || card.classList.contains(filter)) {
                        card.style.display = 'block'; // O 'flex' o 'grid-item' dependiendo del layout de .news-row
                        card.style.animation = 'fadeIn 0.5s ease-out forwards';
                    } else {
                        card.style.animation = 'fadeOut 0.3s ease-out forwards';
                        setTimeout(() => {
                            card.style.display = 'none';
                        }, 300); // Coincidir con la duración de fadeOut
                    }
                });
            }
            
            filterBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    filterBtns.forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    const filterValue = this.getAttribute('data-filter');
                    filterNews(filterValue);
                    
                    // Opcional: Scroll suave al contenedor de noticias si está fuera de vista
                    // newsContainer.scrollIntoView({ behavior: 'smooth', block: 'start' });
                });
            });
            
            // Activar el filtro "Todos" por defecto al cargar la sección
            const allFilterBtn = document.querySelector('#noticias-section .filter-btn[data-filter="all"]');
            if (allFilterBtn) {
                allFilterBtn.classList.add('active');
                // filterNews('all'); // Aplicar filtro inicial - Se comenta para que no se ejecute antes de que la sección sea visible
            }

            // Añadir animaciones fadeIn/fadeOut si no existen
            const styleSheet = document.styleSheets[0];
            let fadeInExists = false;
            let fadeOutExists = false;
            if (styleSheet) { // Asegurarse que styleSheet existe
                for (let i = 0; i < styleSheet.cssRules.length; i++) {
                    if (styleSheet.cssRules[i].name === 'fadeIn') fadeInExists = true;
                    if (styleSheet.cssRules[i].name === 'fadeOut') fadeOutExists = true;
                }

                if (!fadeInExists) {
                    try {
                        styleSheet.insertRule(`
                            @keyframes fadeIn {
                                from { opacity: 0; transform: translateY(15px); }
                                to { opacity: 1; transform: translateY(0); }
                            }`, styleSheet.cssRules.length);
                    } catch (e) {
                        console.error("Error insertando regla fadeIn: ", e);
                    }
                }
                if (!fadeOutExists) {
                     try {
                        styleSheet.insertRule(`
                            @keyframes fadeOut {
                                from { opacity: 1; transform: translateY(0); }
                                to { opacity: 0; transform: translateY(15px); }
                            }`, styleSheet.cssRules.length);
                    } catch (e) {
                        console.error("Error insertando regla fadeOut: ", e);
                    }
                }
            }
        }
    </script>
    <script src="js/scripts.js"></script>
</body>
</html>
